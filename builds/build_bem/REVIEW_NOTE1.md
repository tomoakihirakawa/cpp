# Contents
- [🐋 BEM-MELを使った浮体動揺解析](#-bem-melを使った浮体動揺解析)
    - [⛵ 研究の紹介](#-研究の紹介)
    - [⛵ 水面波と浮体の相互作用の定式化](#-水面波と浮体の相互作用の定式化)
        - [🪼 水面波の境界値問題](#-水面波の境界値問題)
        - [🪼 浮体の運動方程式](#-浮体の運動方程式)


---
# 🐋 BEM-MELを使った浮体動揺解析 

## ⛵ 研究の紹介 

BEMの水面波のシミュレーションでは，
喫水線付近で数値的な不安定が生じやすいことが知られている．
この原因として様々なものが考えられる．

1. メッシュの粗さや形状
2. 補間の方法
3. 時間積分の精度
4. 境界積分方程式の離散化の精度

などである．

メッシュの質とは，
境界面の形状を実際の通りに表現できているか，
さらに，メッシュを使った補間は，境界面上の値の分布をどの程度正確に表現できているかということである．

メッシュの質が悪いと，補間精度が悪化し，
時間積分で用いる補間微分や，境界積分方程式の離散化にも影響を与え，
計算全体の精度に大きな影響を与えると考えられる．

\cite{Donea1982}が提案したArbitrary Lagrangian-Eulerian (ALE)法と呼ばれる手法は，
節点位置の時間発展先として，実際の流速から次時刻の位置を見積もるのではなく，メッシュの質を向上させる位置へと移動させる方法である．

\cite{Zhang2017}は，このALEをBEM-MELに応用し，
単純な円筒型ではなく，円錐台型の浮体の運動の解析方法を提案している．
メッシュは，原点から放射状に広がるレギュラーメッシュを用いている．

\cite{Hirakawa2022}も，ALEと同じ考え方で，メッシュの質を向上させることで，精度の向上を図っている．
メッシュは，非構造メッシュを用いている．

ALE法では，境界条件を満たしながら，次時刻のメッシュの質を向上させるような，節点の移動をどのように決めるかが重要である．
\cite{Hirakawa2022}の方法は，まず，次時刻の境界面$\Gamma(t+\delta t)$を計算し，その境界面上において，メッシュの質を向上させるような節点の移動を決める．
メッシュの質を向上させるような節点の移動方向は，様々考えられ例えば，

* Laplacian smoothing
* Area-weighted smoothing
* Circumcenter to incenter weighted smoothing

などが考えられる．

ここでの研究の目的は，浮体が波の力に応じて自由運動する場合において，
このALE法を使うことでメッシュの質を向上しつつ，浮体の運動をより正確に再現できるかどうかを調べることである．

また，ここでは，浮体の運動をクォータニオンを用いて表現する．
速度ポテンシャルを使って浮体にかかる力を計算には，$\phi _t$を求める必要があるが，
$\phi _t$の計算には，波の運動だけの場合よりも多くの境界値問題を解く必要が出てくる．
補助関数を用いる方法がよく用いられるが，ここでは，準ニュートン法を用いて，$\phi _t$へと収束させる方法を用いる．

## ⛵ 水面波と浮体の相互作用の定式化 

### 🪼 水面波の境界値問題 

デカルト座標系$(x,y,z)$で定義された３次元空間における，水面波と浮体の相互作用を考える．
流体の粘性と渦は無いものとし，流体は非圧縮であるとする．
この場合，流体の流速${\bf u}$は，
流体領域$\Omega$においてラプラス方程式を満たす速度ポテンシャル$\phi$を用いて${\bf u} = \nabla \phi$と表すことができる．
水面はディリクレ境界条件として，速度ポテンシャル$\phi$が与えることができるとする．
また，水が水底や浮体などと接する境界面はノイマン境界条件として，速度ポテンシャル$\phi$の法線微分$\phi _n$が与えることができるとする．
まとめると，水面波の運動は以下の境界値問題として定式化できる．

```math
\begin{align}
\nabla\cdot\nabla \phi& = 0&&\text{in}&&{\bf x} \in \Omega(t),\\
\frac{\partial\phi}{\partial t} +\frac{1}{2}\nabla\phi\cdot\nabla\phi - g z &=0 &&\text{on}&&{\bf x} \in \Gamma^{(\rm D)}(t),\\
\phi _n + {{\bf u} _b}\cdot{{\bf n} _b} &=0&&\text{on}&&{\bf x}\in \Gamma^{(\rm N)}(t),
\end{align}
```

ただし，境界要素法では，ラプラス方程式ではなく，境界積分方程式BIEを解き，速度ポテンシャル$\phi$を求める．

グリーンの定理より，任意の$`\phi`$，$`G`$に対して次が成り立つ．

```math
\iiint _\Omega \left(G({\bf x},{\bf a})\nabla^2 \phi({\bf x}) - \phi({\bf x})\nabla^2 G({\bf x},{\bf a})\right)dV
= \iint _\Gamma {\left( {G({\bf{x}},{\bf{a}})\nabla \phi ({\bf{x}}) - \phi ({\bf{x}})\nabla G({\bf{x}},{\bf{a}})} \right) \cdot {\bf{n}}({\bf{x}})dS}
```

$`\phi`$がラプラス方程式$`\nabla^2\phi=0`$を満たし，$`G=1/\|{\bf x}-{\bf a}\|`$とすると，
グリーンの定理から$`\phi`$と$`\phi _n`$の関係式，BIEが得られる．

```math
\alpha ({\bf{a}})\phi ({\bf{a}}) = \iint _\Gamma {\left( {G({\bf{x}},{\bf{a}})\nabla \phi ({\bf{x}}) - \phi ({\bf{x}})\nabla G({\bf{x}},{\bf{a}})} \right) \cdot {\bf{n}}({\bf{x}})dS}
\quad\text{on}\quad{\bf x} \in \Gamma(t).
```

ここで，$`{\bf a}`$は境界面上の位置ベクトルであり，この原点$`{\bf a}`$を固定し$`{\bf x}`$について面積分される．$`\alpha\left( {\bf{a}} \right)`$は原点での立体角である．

### 🪼 浮体の運動方程式

[./REVIEW_NOTE1_org.md#L1](./REVIEW_NOTE1_org.md#L1)

---
