(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50138,       1237]
NotebookOptionsPosition[     47605,       1184]
NotebookOutlinePosition[     48042,       1202]
CellTagsIndexPosition[     47999,       1199]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[GreaterEqual]", 
      RowBox[{"Abs", "[", "m", "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "n"}], ")"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "m"}], ")"}], "!"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "m"}], ")"}], "!"}]}], "]"}]}], ",", 
     "\"\<q_NaN\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mmax", "=", 
   RowBox[{"nmax", "=", "30"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"CForm", "[", 
     RowBox[{"N", "@", 
      RowBox[{"A", "[", 
       RowBox[{"n", ",", "m"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.929127617796736*^9, 3.929127693782792*^9}, {
   3.929127726010971*^9, 3.929127784339571*^9}, {3.92912784352229*^9, 
   3.9291279158273163`*^9}, {3.9291506531410313`*^9, 3.9291506679011*^9}, {
   3.929150711777975*^9, 3.929150729892171*^9}, {3.9291507631219807`*^9, 
   3.929150828674464*^9}, {3.929150920570922*^9, 3.929150948803349*^9}, {
   3.9291510195057*^9, 3.929151043692285*^9}, {3.929151087914053*^9, 
   3.9291511006458387`*^9}, {3.929151277340851*^9, 3.929151284571697*^9}, 
   3.929151484588286*^9, {3.9291515483129787`*^9, 3.929151572208767*^9}, 
   3.929152093207521*^9, {3.929152447775321*^9, 3.929152467940197*^9}, {
   3.9291526267308483`*^9, 3.929152646410368*^9}, {3.929152684983156*^9, 
   3.929152693232027*^9}, {3.929152792066842*^9, 3.929152800675191*^9}, {
   3.929153073879196*^9, 3.929153075064489*^9}, {3.9291532472591267`*^9, 
   3.929153263566328*^9}, {3.929153354500104*^9, 3.929153393153412*^9}, {
   3.929155729839245*^9, 3.92915573631601*^9}, {3.929156165894836*^9, 
   3.929156206045001*^9}, {3.929156279144671*^9, 3.9291565002455378`*^9}, {
   3.9291565691138687`*^9, 3.929156581294384*^9}, {3.929156615129815*^9, 
   3.9291566177489433`*^9}, {3.929177378844471*^9, 3.929177457982299*^9}, {
   3.929177504105619*^9, 3.929177509110042*^9}, {3.929234984071238*^9, 
   3.929234993425789*^9}, {3.92923537678668*^9, 3.9292353769877977`*^9}, 
   3.9294786183774*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"7b87a041-f96b-476d-8e6e-c23284dd32f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"31", ",", "61"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9292401547048607`*^9, 3.9292408136157722`*^9, 3.929478572447242*^9, {
   3.929478883422235*^9, 3.929478903963419*^9}, 3.929479149595647*^9, {
   3.9294792556822577`*^9, 3.92947927857578*^9}, 3.929479319788331*^9, 
   3.929520253136277*^9, 3.929520728004383*^9, 3.929521781077394*^9, 
   3.929522429515521*^9, {3.929522459875573*^9, 3.929522475353622*^9}, 
   3.929522519183063*^9, 3.929522961249031*^9, 3.9295231273050632`*^9, 
   3.929523167855583*^9, 3.9295244345157948`*^9, {3.929524467344139*^9, 
   3.929524488345886*^9}, {3.929524528845716*^9, 3.929524559617792*^9}, 
   3.92952476865574*^9, 3.929524883005443*^9, 3.929525315077484*^9, {
   3.929525473360303*^9, 3.929525483235313*^9}, 3.929525582586762*^9, 
   3.929525644842319*^9, 3.929525727632564*^9, 3.929526114901847*^9, 
   3.929526280485104*^9, 3.929526914559607*^9, 3.932414939095059*^9, 
   3.932945164770096*^9, 3.932945201748272*^9, 3.932945235479535*^9, 
   3.932945578556904*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"1a72f7c6-0ecd-4381-95e8-239cb35dfa57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mmax", "=", 
   RowBox[{"nmax", "=", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"n_", ",", "m_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"n", "\[GreaterEqual]", 
      RowBox[{"Abs", "[", "m", "]"}]}], "&&", 
     RowBox[{"j", "\[GreaterEqual]", 
      RowBox[{"Abs", "[", "k", "]"}]}]}], ",", 
    FractionBox[
     RowBox[{"A", "[", 
      RowBox[{"n", ",", "m"}], "]"}], 
     RowBox[{"A", "[", 
      RowBox[{"j", ",", "k"}], "]"}]], ",", "\"\<q_NaN\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ParallelTable", "[", 
  RowBox[{
   RowBox[{"CForm", "[", 
    RowBox[{"N", "[", 
     RowBox[{"F", "[", 
      RowBox[{"n", ",", "m", ",", "j", ",", "k"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "nmax"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", 
     RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.929236653022167*^9, 3.92923676216914*^9}, {
   3.929239262776229*^9, 3.9292392648915*^9}, {3.929240233707418*^9, 
   3.9292402994337187`*^9}, {3.929240444129994*^9, 3.929240472688941*^9}, {
   3.92924102993727*^9, 3.929241035574123*^9}, 3.929241430497045*^9, {
   3.932945192911312*^9, 3.932945197608925*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"a2a5b0ee-33c1-46d3-8514-41174862a17d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"1.\"\>",
          CForm[1.],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"-0.7071067811865475\"\>",
          CForm[-0.7071067811865475],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"-1.\"\>",
          CForm[-1.],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"-0.7071067811865475\"\>",
          CForm[-0.7071067811865475],
          AutoDelete->True,
          Editable->True]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"-1.\"\>",
          CForm[-1.],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"0.7071067811865475\"\>",
          CForm[0.7071067811865475],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"1.\"\>",
          CForm[1.],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"0.7071067811865475\"\>",
          CForm[0.7071067811865475],
          AutoDelete->True,
          Editable->True]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"-1.4142135623730951\"\>",
          CForm[-1.4142135623730951`],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"\\\"q_NaN\\\"\"\>",
          CForm["q_NaN"],
          AutoDelete->True,
          Editable->True]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox["\<\"1.\"\>",
          CForm[1.],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"1.4142135623730951\"\>",
          CForm[1.4142135623730951`],
          AutoDelete->True,
          Editable->True], ",", 
         InterpretationBox["\<\"1.\"\>",
          CForm[1.],
          AutoDelete->True,
          Editable->True]}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.929152154163596*^9, 3.9291521666145687`*^9}, {
   3.929152448505032*^9, 3.929152470240103*^9}, 3.92915265106688*^9, 
   3.929152694055121*^9, 3.929152733308226*^9, 3.929153087595112*^9, 
   3.929156294598433*^9, 3.929156496344256*^9, 3.9291565444768476`*^9, {
   3.929156574904903*^9, 3.929156581869895*^9}, 3.929177417353804*^9, {
   3.929236752939905*^9, 3.929236762703867*^9}, 3.929239268672184*^9, 
   3.9292403003609333`*^9, {3.929240466985649*^9, 3.929240475085532*^9}, 
   3.9292410362196913`*^9, 3.929241431118123*^9, 3.929241729501169*^9, 
   3.929478572537259*^9, {3.929478883497696*^9, 3.929478904036087*^9}, 
   3.929479149685504*^9, {3.929479255753133*^9, 3.929479278650415*^9}, 
   3.92947931988006*^9, 3.929520253191828*^9, 3.929520728011269*^9, 
   3.929521781121791*^9, 3.929522429570553*^9, {3.929522459917293*^9, 
   3.929522475397092*^9}, 3.929522519222416*^9, 3.929522961293982*^9, 
   3.9295231273500338`*^9, 3.929523167900329*^9, 3.929524434557403*^9, {
   3.929524467387113*^9, 3.929524488373021*^9}, {3.929524528881629*^9, 
   3.9295245596485147`*^9}, 3.929524768683548*^9, 3.929524883047661*^9, 
   3.9295253151031218`*^9, {3.929525473391069*^9, 3.929525483269578*^9}, 
   3.9295255826215553`*^9, 3.929525644872652*^9, 3.929525727664855*^9, 
   3.9295261149295073`*^9, 3.929526280517741*^9, 3.929526918350067*^9, 
   3.9324149408846273`*^9, 3.9329451651179743`*^9, 3.932945203109015*^9, 
   3.9329452355291767`*^9, 3.932945578596772*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"e9cff216-a5be-4f5a-8911-165f174653af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mmax", "=", 
   RowBox[{"nmax", "=", "20"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"arraytype", "=", 
  RowBox[{"ToString", "[", 
   RowBox[{
   "\"\<std::array<std::array<std::array<std::array<std::complex<double>,\>\"\
", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"2", "*", "nmax"}], "+", "1"}], "]"}], "<>", "\"\<>,\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"nmax", "+", "1"}], "]"}], "<>", "\"\<>,\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"2", "*", "nmax"}], "+", "1"}], "]"}], "<>", "\"\<>,\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"nmax", "+", "1"}], "]"}], "<>", "\"\<>\>\""}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9294789881327553`*^9, 3.929478990337701*^9}, {
   3.929479087897785*^9, 3.9294791299983807`*^9}, {3.929479224335387*^9, 
   3.929479243737249*^9}, {3.929479362131575*^9, 3.929479362276019*^9}, {
   3.9295201453272657`*^9, 3.9295201683701973`*^9}, {3.929520228158862*^9, 
   3.929520228503737*^9}, 3.9295213677534323`*^9, 3.929522426959922*^9, {
   3.929522458039894*^9, 3.9295224586198397`*^9}, {3.9295225165178137`*^9, 
   3.929522517097288*^9}, {3.929522959577777*^9, 3.9295229596394243`*^9}, {
   3.9295231666722507`*^9, 3.929523166725638*^9}, {3.929524433882662*^9, 
   3.929524433954138*^9}, {3.929524881912229*^9, 3.929524881988873*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"12315844-3022-4d7f-a2cc-128d4194ec79"],

Cell[BoxData["\<\"std::array<std::array<std::array<std::array<std::complex<\
double>,41>,21>,41>,21>\"\>"], "Output",
 CellChangeTimes->{
  3.929520168651875*^9, {3.9295202289317913`*^9, 3.929520253230034*^9}, 
   3.9295207280442123`*^9, 3.929521370081251*^9, 3.929521781127842*^9, 
   3.929522429579648*^9, {3.9295224599238462`*^9, 3.929522475404951*^9}, 
   3.92952251922884*^9, 3.9295229613012*^9, 3.929523127357402*^9, 
   3.929523167905616*^9, 3.929524434562759*^9, {3.9295244673959703`*^9, 
   3.929524488378543*^9}, {3.929524528887129*^9, 3.929524559654971*^9}, 
   3.929524768689394*^9, 3.9295248830531063`*^9, 3.929525315108633*^9, {
   3.929525473398823*^9, 3.9295254832753763`*^9}, 3.929525582630125*^9, 
   3.929525644878763*^9, 3.929525727670583*^9, 3.929526114935034*^9, 
   3.9295262805243597`*^9, 3.9295269184756413`*^9, 3.932414941606032*^9, 
   3.932945165147745*^9, {3.932945209241537*^9, 3.932945236591651*^9}, 
   3.932945578601202*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"18e57433-1cdd-4f96-bb11-0399f05ad62a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", "n"}], ")"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "m"}], ")"}], "!"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", "m"}], ")"}], "!"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.929243700514093*^9, {3.929243957381036*^9, 3.929243957889174*^9}, {
   3.929245378967622*^9, 3.92924538528234*^9}, {3.9294783730795193`*^9, 
   3.929478418367258*^9}, {3.929478901216899*^9, 3.929478901911791*^9}, {
   3.929478979664435*^9, 3.9294789864177237`*^9}, {3.929520483726088*^9, 
   3.929520512315487*^9}, {3.9295208581851187`*^9, 3.9295208982516117`*^9}, {
   3.929521083366157*^9, 3.9295211270021544`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"95fd2f0c-f392-46e8-9425-62453b95d61e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\:6570\:5024\:3092", "-", 
    RowBox[{
     RowBox[{"e", "/", 
      RowBox[{"+", "e"}]}], " ", 
     "\:5f62\:5f0f\:306b\:5909\:63db\:3059\:308b\:95a2\:6570"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AAA", "[", 
     RowBox[{"n_", ",", "m_", ",", "j_", ",", "k_", ",", "p_", ",", "q_"}], 
     "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"n", "\[GreaterEqual]", 
        RowBox[{"Abs", "[", "m", "]"}]}], "&&", 
       RowBox[{"j", "\[GreaterEqual]", 
        RowBox[{"Abs", "[", "k", "]"}]}], "&&", 
       RowBox[{"p", "\[GreaterEqual]", 
        RowBox[{"Abs", "[", "q", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"\[ImaginaryI]", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "@", 
            RowBox[{"(", "q", ")"}]}], "-", 
           RowBox[{"Abs", "@", 
            RowBox[{"(", "m", ")"}]}], "-", 
           RowBox[{"Abs", "@", 
            RowBox[{"(", "k", ")"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<std::complex<double>\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"A", "[", 
                 RowBox[{"n", ",", "m"}], "]"}], "*", 
                RowBox[{"A", "[", 
                 RowBox[{"j", ",", "k"}], "]"}]}], 
               RowBox[{"A", "[", 
                RowBox[{"p", ",", "q"}], "]"}]], 
              RowBox[{"Re", "[", "c", "]"}]}], ",", 
             RowBox[{"Im", "[", "c", "]"}]}], "}"}]}], ",", "InputForm"}], 
         "]"}]}]}], ",", "\"\<complex0\>\""}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AAA", "[", 
          RowBox[{"n", ",", "m", ",", 
           RowBox[{"j", "-", "n"}], ",", 
           RowBox[{"k", "-", "m"}], ",", "j", ",", "k"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<*^\>\"", "\[Rule]", "\"\<e\>\""}], ",", 
           RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
           RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<)\>\""}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\:30c7\:30fc\:30bf\:3092\:5909\:63db", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cppDataString", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"data", ",", "InputForm"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<{{\>\""}], ",", 
         RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<}}\>\""}], ",", 
         RowBox[{"\"\<\\\"\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"cppArray", "=", 
     RowBox[{"\"\<static const int N_AAA_M2M_FMM=\>\"", "<>", 
      RowBox[{"ToString", "[", "mmax", "]"}], "<>", "\"\<;static const \>\"", 
      "<>", "arraytype", "<>", "\"\< AAA_M2M_FMM = \>\"", "<>", 
      "cppDataString", "<>", "\"\<;\>\""}]}], ";"}], "\n", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\</Users/tomoaki/Library/CloudStorage/Dropbox/code/cpp/include\>\"",
         ",", "\"\<AAA_M2M_FMM.hpp\>\""}], "}"}], "]"}], ",", "cppArray", 
     ",", "\"\<Text\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.92924180093685*^9, 3.929241800939569*^9}, {
   3.9292418434453487`*^9, 3.929242024659766*^9}, {3.929242119842732*^9, 
   3.9292421496933947`*^9}, {3.9292432278868303`*^9, 3.929243229622162*^9}, {
   3.929243405982719*^9, 3.929243602987049*^9}, {3.9292436627760067`*^9, 
   3.929243736952322*^9}, {3.9292437897436743`*^9, 3.9292438237149153`*^9}, {
   3.9292440324236917`*^9, 3.929244032789071*^9}, 3.929244149560772*^9, {
   3.929244318589645*^9, 3.929244322590597*^9}, {3.9292444321755037`*^9, 
   3.9292444341812773`*^9}, {3.929244555181229*^9, 3.929244555501309*^9}, {
   3.929245074166335*^9, 3.929245079845305*^9}, {3.929478440952187*^9, 
   3.929478472846219*^9}, 3.929478519022908*^9, 3.929478845369915*^9, {
   3.929478969329157*^9, 3.929478975196926*^9}, 3.929479132801792*^9, {
   3.9294792964899683`*^9, 3.929479300090719*^9}, 3.929520238389241*^9, {
   3.929520295281814*^9, 3.929520389665831*^9}, {3.9295205398678617`*^9, 
   3.929520676145965*^9}, {3.929520711597354*^9, 3.9295207202431*^9}, {
   3.929520755401987*^9, 3.9295208065835543`*^9}, {3.929520848986637*^9, 
   3.929520852150401*^9}, 3.92952088780908*^9, {3.92952092481008*^9, 
   3.9295209435109663`*^9}, {3.929521006843438*^9, 3.929521052165214*^9}, {
   3.929521118368978*^9, 3.929521129573542*^9}, {3.92952310212462*^9, 
   3.9295231037093143`*^9}, {3.9295244088641863`*^9, 3.929524420888976*^9}, {
   3.929524463966419*^9, 3.929524476104681*^9}, {3.929524521868181*^9, 
   3.9295245546790037`*^9}, {3.9295246190797586`*^9, 3.929524683972611*^9}, 
   3.9295253076266413`*^9, {3.929525434571466*^9, 3.929525459934162*^9}, {
   3.929525606321075*^9, 3.929525626871819*^9}, {3.929525833760057*^9, 
   3.929525876300309*^9}, {3.929526067851838*^9, 3.929526086851221*^9}, {
   3.932945131763949*^9, 3.932945133055868*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"21b1575e-f438-488f-82c7-6312b46261da"],

Cell[BoxData["\<\"/Users/tomoaki/Library/CloudStorage/Dropbox/code/cpp/\
include/AAA_M2M_FMM.hpp\"\>"], "Output",
 CellChangeTimes->{{3.9295206183476963`*^9, 3.929520676842333*^9}, {
   3.929520711138831*^9, 3.9295207351394863`*^9}, {3.92952077997784*^9, 
   3.929520814492527*^9}, {3.929520859556551*^9, 3.9295208687988873`*^9}, 
   3.929520900716434*^9, 3.929520944040064*^9, 3.929521015711611*^9, 
   3.929521101112183*^9, 3.929521379166998*^9, 3.929521787339304*^9, 
   3.9295224296420107`*^9, {3.929522459968532*^9, 3.929522475454205*^9}, 
   3.929522521888867*^9, 3.929522961521865*^9, {3.929523104392241*^9, 
   3.9295231275672894`*^9}, 3.929523169939043*^9, 3.929524434779913*^9, {
   3.9295244653697*^9, 3.92952448859872*^9}, {3.9295245292291927`*^9, 
   3.9295245598499527`*^9}, 3.9295246357672577`*^9, 3.9295246667712708`*^9, 
   3.929524768871464*^9, 3.929524885219222*^9, 3.929525321090734*^9, {
   3.929525479334688*^9, 3.9295254891935387`*^9}, 3.9295255886626663`*^9, 
   3.929525650946867*^9, 3.929525733668181*^9, 3.92952612102978*^9, 
   3.929526286659008*^9, 3.9295269244973373`*^9, 3.932414945905387*^9, 
   3.932945169471614*^9, 3.932945242340619*^9, 3.9329455829522*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"410f6d32-6482-490f-8815-50617ee048c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AAA", "[", 
    RowBox[{"n_", ",", "m_", ",", "j_", ",", "k_", ",", "p_", ",", "q_"}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[GreaterEqual]", 
       RowBox[{"Abs", "[", "m", "]"}]}], "&&", 
      RowBox[{"j", "\[GreaterEqual]", 
       RowBox[{"Abs", "[", "k", "]"}]}], "&&", 
      RowBox[{"p", "\[GreaterEqual]", 
       RowBox[{"Abs", "[", "q", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"\[ImaginaryI]", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "@", 
           RowBox[{"(", "q", ")"}]}], "-", 
          RowBox[{"Abs", "@", 
           RowBox[{"(", "m", ")"}]}], "-", 
          RowBox[{"Abs", "@", 
           RowBox[{"(", "k", ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\"\<std::complex<double>\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{"n", ",", "m"}], "]"}], "*", 
               RowBox[{"A", "[", 
                RowBox[{"j", ",", "k"}], "]"}]}], 
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{"p", ",", "q"}], "]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "n"}]}]], 
             RowBox[{"Re", "[", "c", "]"}]}], ",", 
            RowBox[{"Im", "[", "c", "]"}]}], "}"}]}], ",", "InputForm"}], 
        "]"}]}]}], ",", "\"\<complex0\>\""}], "]"}]}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"N", "[", 
        FractionBox[
         RowBox[{"AAA", "[", 
          RowBox[{"n", ",", "m", ",", "j", ",", "k", ",", 
           RowBox[{"j", "+", "n"}], ",", 
           RowBox[{"m", "-", "k"}]}], "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "n"}]], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\:6570\:5024\:3092", "-", 
    RowBox[{
     RowBox[{"e", "/", 
      RowBox[{"+", "e"}]}], " ", 
     "\:5f62\:5f0f\:306b\:5909\:63db\:3059\:308b\:95a2\:6570"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AAA", "[", 
         RowBox[{"n", ",", "m", ",", "j", ",", "k", ",", 
          RowBox[{"j", "+", "n"}], ",", 
          RowBox[{"m", "-", "k"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<*^\>\"", "\[Rule]", "\"\<e\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<)\>\""}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "nmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{
  "(*", "\:30c7\:30fc\:30bf\:3092\:5909\:63db", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cppDataString", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"data", ",", "InputForm"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<{{\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<}}\>\""}], ",", 
       RowBox[{"\"\<\\\"\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"cppArray", "=", 
   RowBox[{"\"\<static const int N_AAA_M2L_FMM=\>\"", "<>", 
    RowBox[{"ToString", "[", "mmax", "]"}], "<>", "\"\<;static const \>\"", "<>",
     "arraytype", "<>", "\"\< AAA_M2L_FMM = \>\"", "<>", "cppDataString", 
    "<>", "\"\<;\>\""}]}], ";"}], "\n", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\</Users/tomoaki/Library/CloudStorage/Dropbox/code/cpp/include\>\"", 
      ",", "\"\<AAA_M2L_FMM.hpp\>\""}], "}"}], "]"}], ",", "cppArray", ",", 
   "\"\<Text\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.9292443251024218`*^9, 3.929244328979805*^9}, {
   3.929244560487515*^9, 3.929244560826407*^9}, {3.929245065497377*^9, 
   3.9292450696121197`*^9}, {3.9292451509619226`*^9, 
   3.9292451579519033`*^9}, {3.92947848850772*^9, 3.92947851651466*^9}, {
   3.929478840284956*^9, 3.9294788664387817`*^9}, 3.929479142378978*^9, 
   3.929479304642457*^9, 3.929520844395362*^9, {3.929521162885847*^9, 
   3.929521169703233*^9}, {3.929521236754777*^9, 3.929521279893612*^9}, {
   3.929523109385043*^9, 3.929523110222848*^9}, {3.9295244265153513`*^9, 
   3.929524426756534*^9}, {3.929524481119751*^9, 3.929524485145193*^9}, {
   3.929524526521542*^9, 3.929524559244875*^9}, {3.929524690474361*^9, 
   3.929524713981311*^9}, 3.929525173851859*^9, {3.929525254921013*^9, 
   3.929525273023078*^9}, {3.929525303969077*^9, 3.9295253052503643`*^9}, 
   3.9295254151256123`*^9, {3.9295254627035913`*^9, 3.929525482197863*^9}, {
   3.929525632940847*^9, 3.929525638879163*^9}, {3.929526023890067*^9, 
   3.9295260447899437`*^9}, {3.932945139289365*^9, 3.932945146814529*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"774be7df-8518-45ff-90de-903c14013348"],

Cell[BoxData["\<\"/Users/tomoaki/Library/CloudStorage/Dropbox/code/cpp/\
include/AAA_M2L_FMM.hpp\"\>"], "Output",
 CellChangeTimes->{{3.929243948406824*^9, 3.929243972298067*^9}, 
   3.929244346139455*^9, 3.9292445737915983`*^9, 3.9292451725758963`*^9, 
   3.929245399099576*^9, 3.9294785792667294`*^9, 3.929478890182795*^9, 
   3.929478920740883*^9, 3.9294791665395*^9, {3.929479262617044*^9, 
   3.9294792855406437`*^9}, 3.929479326642971*^9, {3.9295212747100163`*^9, 
   3.929521280393355*^9}, 3.9295218091154337`*^9, 3.9295224296886663`*^9, {
   3.929522459992962*^9, 3.929522475479785*^9}, 3.929522529988894*^9, 
   3.9295229620174923`*^9, {3.929523111130991*^9, 3.929523128035878*^9}, 
   3.92952317776686*^9, 3.9295244352891817`*^9, {3.929524468103262*^9, 
   3.9295244891105537`*^9}, {3.9295245297993097`*^9, 3.929524560311363*^9}, 
   3.9295247693283587`*^9, 3.929524893141191*^9, 3.929525182978448*^9, 
   3.929525342310219*^9, 3.9295255110859823`*^9, 3.929525610517144*^9, 
   3.92952567297093*^9, 3.92952575557975*^9, 3.929526143480591*^9, 
   3.929526308973014*^9, 3.929526946409491*^9, 3.932414962685688*^9, 
   3.932945259052619*^9, 3.932945599430544*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"02855c87-2b54-40dd-a688-2048a920fb9e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AAA", "[", 
    RowBox[{"n_", ",", "m_", ",", "j_", ",", "k_", ",", "p_", ",", "q_"}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[GreaterEqual]", 
       RowBox[{"Abs", "[", "m", "]"}]}], "&&", 
      RowBox[{"j", "\[GreaterEqual]", 
       RowBox[{"Abs", "[", "k", "]"}]}], "&&", 
      RowBox[{"p", "\[GreaterEqual]", 
       RowBox[{"Abs", "[", "q", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"\[ImaginaryI]", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Abs", "@", 
           RowBox[{"(", "q", ")"}]}], "-", 
          RowBox[{"Abs", "@", 
           RowBox[{"(", "m", ")"}]}], "-", 
          RowBox[{"Abs", "@", 
           RowBox[{"(", "k", ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\"\<std::complex<double>\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{"n", ",", "m"}], "]"}], "*", 
               RowBox[{"A", "[", 
                RowBox[{"j", ",", "k"}], "]"}]}], 
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{"p", ",", "q"}], "]"}], "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "n"}]}]], 
             RowBox[{"Re", "[", "c", "]"}]}], ",", 
            RowBox[{"Im", "[", "c", "]"}]}], "}"}]}], ",", "InputForm"}], 
        "]"}]}]}], ",", "\"\<complex0\>\""}], "]"}]}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{"\:6570\:5024\:3092", "-", 
    RowBox[{
     RowBox[{"e", "/", 
      RowBox[{"+", "e"}]}], " ", 
     "\:5f62\:5f0f\:306b\:5909\:63db\:3059\:308b\:95a2\:6570"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AAA", "[", 
         RowBox[{
          RowBox[{"n", "-", "j"}], ",", 
          RowBox[{"m", "-", "k"}], ",", "j", ",", "k", ",", "n", ",", "m"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<*^\>\"", "\[Rule]", "\"\<e\>\""}], ",", 
          RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<)\>\""}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "nmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"-", "mmax"}], ",", "mmax"}], "}"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{
  "(*", "\:30c7\:30fc\:30bf\:3092\:5909\:63db", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cppDataString", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"data", ",", "InputForm"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<{{\>\""}], ",", 
       RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<}}\>\""}], ",", 
       RowBox[{"\"\<\\\"\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cppArray", "=", 
    RowBox[{"\"\<static const int N_AAA_L2L_FMM=\>\"", "<>", 
     RowBox[{"ToString", "[", "mmax", "]"}], "<>", "\"\<;static const \>\"", "<>",
      "arraytype", "<>", "\"\< AAA_L2L_FMM = \>\"", "<>", "cppDataString", 
     "<>", "\"\<;\>\""}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\</Users/tomoaki/Library/CloudStorage/Dropbox/code/cpp/include\>\"", 
       ",", "\"\<AAA_L2L_FMM.hpp\>\""}], "}"}], "]"}], ",", "cppArray", ",", 
    "\"\<Text\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.92924371535763*^9, 3.929243740658242*^9}, {
   3.929243881426148*^9, 3.929243916102846*^9}, {3.92924403709762*^9, 
   3.929244037545041*^9}, {3.929244330827094*^9, 3.92924433382718*^9}, {
   3.929244563369246*^9, 3.92924456360338*^9}, {3.929245051547339*^9, 
   3.929245057191265*^9}, {3.929245141302536*^9, 3.9292451476016893`*^9}, {
   3.929478533344042*^9, 3.929478570410367*^9}, {3.929478842648237*^9, 
   3.929478880137683*^9}, 3.929479148297193*^9, 3.929479308781713*^9, {
   3.92952128655444*^9, 3.9295213598201017`*^9}, 3.929523113727346*^9, {
   3.929524429777769*^9, 3.92952443007054*^9}, 3.929524487444161*^9, {
   3.929524527854714*^9, 3.929524538486809*^9}, 3.929524691450761*^9, {
   3.92952475816593*^9, 3.9295247672919817`*^9}, 3.9295253138677597`*^9, {
   3.929525360622609*^9, 3.929525367658454*^9}, {3.929525406152927*^9, 
   3.9295254087379093`*^9}, 3.9295254645019627`*^9, {3.9295256405113373`*^9, 
   3.92952564257908*^9}, {3.929525717912601*^9, 3.929525722822133*^9}, {
   3.9295260922390003`*^9, 3.929526108379987*^9}, 3.929526276232481*^9, 
   3.92952633208298*^9, {3.9329451514292707`*^9, 3.932945152833201*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"8ee25b0e-d478-4213-b890-20fcc0b4e68e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"abs", "[", "m_", "]"}], ":=", 
    RowBox[{"Abs", "[", "m", "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"m", ">", "0"}], ",", "m", ",", 
      RowBox[{"-", "m"}]}], "]"}], "*)"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"abs", "[", "m_", "]"}], ":=", 
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "m", "]"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"m", ">", "0"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{"n_", ",", "m_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", "m"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"x", "^", "2"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"m", "/", "2"}], ")"}]}], "*", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"n", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "m"}], "}"}]}], "]"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SuperscriptBox["P", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"n_", ",", "m_", ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"m", "*", "x"}], 
      RowBox[{"1", "-", 
       RowBox[{"x", "^", "2"}]}]]}], "*", 
    RowBox[{"P", "[", 
     RowBox[{"n", ",", "m", ",", "x"}], "]"}]}], "-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{"x", "^", "2"}]}], "]"}]], 
    RowBox[{"P", "[", 
     RowBox[{"n", ",", 
      RowBox[{"m", "+", "1"}], ",", "x"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Rho]", "^", "n"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"abs", "[", "m", "]"}]}], ")"}], "!"}], "/", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "+", 
        RowBox[{"abs", "[", "m", "]"}]}], ")"}], "!"}]}], "]"}], "*", 
   RowBox[{"P", "[", 
    RowBox[{"n", ",", 
     RowBox[{"abs", "[", "m", "]"}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"\[ImaginaryI]", "*", "m", "*", "\[Phi]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"n", ",", "m"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ">", "0"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.940724310646429*^9, 3.940724398135483*^9}, {
   3.940724557067423*^9, 3.94072473385926*^9}, {3.9407260041590157`*^9, 
   3.940726049427703*^9}, {3.940726117065263*^9, 3.940726125870425*^9}, 
   3.9407261741873913`*^9, {3.9407262278785467`*^9, 3.940726308385524*^9}, {
   3.9407263559823503`*^9, 3.940726364695683*^9}, {3.940726397792132*^9, 
   3.940726398313493*^9}, {3.9407264667153177`*^9, 3.940726468952197*^9}, {
   3.9407265169832373`*^9, 3.9407265383886538`*^9}, {3.9407266997651043`*^9, 
   3.940726700124589*^9}, {3.940727026822289*^9, 3.9407271759283857`*^9}, 
   3.940727231372965*^9, {3.94073225034109*^9, 3.9407322761261997`*^9}, {
   3.9407332546223583`*^9, 3.940733267937703*^9}},
 CellLabel->
  "In[2754]:=",ExpressionUUID->"463018c0-a8df-425d-b261-a2a39e034346"],

Cell["\<\
Power(E,I*m*\[Phi])*Power(\[Rho],n)*Sqrt(Factorial(-m + n)/Factorial(m + n))*
   (m*Cot(\[Theta])*P(n,m,Cos(\[Theta])) + P(n,1 + m,Cos(\[Theta])))\
\>", "Output",
 CellChangeTimes->{
  3.940726540829928*^9, {3.940726696635676*^9, 3.94072671855167*^9}, 
   3.9407268362058983`*^9, 3.940726982897468*^9, {3.9407270381400337`*^9, 
   3.940727066883333*^9}, 3.940727100684805*^9, 3.940727133908597*^9, 
   3.940727181540483*^9, 3.940727232469412*^9, 3.940727322724104*^9, 
   3.940730696845478*^9, 3.9407308635626917`*^9, 3.940731348152125*^9, 
   3.940731435916485*^9, {3.940732260566635*^9, 3.9407322961000423`*^9}, 
   3.9407332812701473`*^9, 3.940733520233912*^9},
 CellLabel->
  "Out[2759]//CForm=",ExpressionUUID->"04c39c98-b329-4af7-9a8f-89c3c8b65d5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"n", ",", "m"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "<", "0"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{3.94073227869139*^9},
 CellLabel->
  "In[2760]:=",ExpressionUUID->"6e94b03e-3d0d-4f47-b0ee-395796bc90d9"],

Cell["\<\
Power(E,I*m*\[Phi])*Power(\[Rho],n)*Sqrt(Factorial(-m + n)/Factorial(m + n))*
   (m*Cot(\[Theta])*P(n,m,Cos(\[Theta])) - P(n,1 + m,Cos(\[Theta])))\
\>", "Output",
 CellChangeTimes->{
  3.940724398601841*^9, {3.940724618109209*^9, 3.940724734764668*^9}, 
   3.940726049904613*^9, 3.9407261263615837`*^9, 3.94072619130125*^9, 
   3.940726233573018*^9, 3.940726309233863*^9, {3.940726360549284*^9, 
   3.940726365456053*^9}, 3.940726398889759*^9, {3.9407264553167887`*^9, 
   3.940726469481773*^9}, {3.9407265263897533`*^9, 3.9407265409803877`*^9}, {
   3.940726697394631*^9, 3.940726718705051*^9}, 3.940726983026668*^9, 
   3.940727322851931*^9, 3.9407306969907312`*^9, 3.940730863721883*^9, 
   3.940731348306155*^9, {3.940732260756651*^9, 3.940732296811228*^9}, 
   3.940733281432317*^9, 3.9407335202721643`*^9},
 CellLabel->
  "Out[2761]//CForm=",ExpressionUUID->"105210cb-624e-4e77-bee2-9cb7c40b3ce5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"abs", "[", "m_", "]"}], ":=", 
  RowBox[{"Refine", "[", 
   RowBox[{
    RowBox[{"Abs", "[", "m", "]"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"m", "<", "0"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Rho]", "^", "n"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"abs", "[", "m", "]"}]}], ")"}], "!"}], "/", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "+", 
        RowBox[{"abs", "[", "m", "]"}]}], ")"}], "!"}]}], "]"}], "*", 
   RowBox[{"P", "[", 
    RowBox[{"n", ",", 
     RowBox[{"abs", "[", "m", "]"}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"\[ImaginaryI]", "*", "m", "*", "\[Phi]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"n", ",", "m"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ">", "0"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.940724310646429*^9, 3.940724398135483*^9}, {
   3.940724557067423*^9, 3.94072473385926*^9}, {3.9407260041590157`*^9, 
   3.940726049427703*^9}, {3.940726117065263*^9, 3.940726125870425*^9}, 
   3.9407261741873913`*^9, {3.9407262278785467`*^9, 3.940726308385524*^9}, {
   3.9407263559823503`*^9, 3.940726364695683*^9}, {3.940726397792132*^9, 
   3.940726398313493*^9}, {3.9407264667153177`*^9, 3.940726468952197*^9}, {
   3.9407265169832373`*^9, 3.9407265383886538`*^9}, {3.9407266997651043`*^9, 
   3.940726715304564*^9}, {3.940732255439158*^9, 3.94073228251832*^9}, 
   3.9407332772737637`*^9, {3.940733665165063*^9, 
   3.940733671539797*^9}},ExpressionUUID->"ba0e7503-4848-4cfc-993b-\
7179c710558d"],

Cell["\<\
Power(E,I*m*\[Phi])*Power(\[Rho],n)*Sqrt(Factorial(m + n)/Factorial(-m + n))*
   (P(n,1 - m,Cos(\[Theta])) - m*Cot(\[Theta])*P(n,-m,Cos(\[Theta])))\
\>", "Output",
 CellChangeTimes->{
  3.940726540829928*^9, {3.940726696635676*^9, 3.940726718839538*^9}, 
   3.940726983157292*^9, 3.9407273229728823`*^9, {3.9407306909687862`*^9, 
   3.940730697121859*^9}, 3.940730863876339*^9, 3.940731348433104*^9, {
   3.9407322608999863`*^9, 3.9407322968480864`*^9}, 3.9407332815817747`*^9, 
   3.940733520305805*^9},
 CellLabel->
  "Out[2767]//CForm=",ExpressionUUID->"8a6c683c-37b6-4608-945a-4b981fc6adf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"n", ",", "m"}], "]"}], ",", "\[Theta]"}], "]"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "<", "0"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{3.940732284376357*^9},
 CellLabel->
  "In[2768]:=",ExpressionUUID->"e26ca78a-87d3-4ac2-b4bd-b20bfcba0809"],

Cell["\<\
-(Power(E,I*m*\[Phi])*Power(\[Rho],n)*Sqrt(Factorial(m + n)/Factorial(-m + n))*
     (P(n,1 - m,Cos(\[Theta])) + m*Cot(\[Theta])*P(n,-m,Cos(\[Theta]))))\
\>", "Output",
 CellChangeTimes->{
  3.940724398601841*^9, {3.940724618109209*^9, 3.940724734764668*^9}, 
   3.940726049904613*^9, 3.9407261263615837`*^9, 3.94072619130125*^9, 
   3.940726233573018*^9, 3.940726309233863*^9, {3.940726360549284*^9, 
   3.940726365456053*^9}, 3.940726398889759*^9, {3.9407264553167887`*^9, 
   3.940726469481773*^9}, {3.9407265263897533`*^9, 3.9407265409803877`*^9}, {
   3.940726697394631*^9, 3.940726718989151*^9}, 3.940726983337799*^9, 
   3.940727323104397*^9, 3.940730697263699*^9, 3.940730864025601*^9, 
   3.9407313485755157`*^9, {3.9407322610288553`*^9, 3.940732296866412*^9}, 
   3.940733281700049*^9, 3.94073352031936*^9},
 CellLabel->
  "Out[2769]//CForm=",ExpressionUUID->"257c8196-c266-44ff-9007-b2ee2c8225c4"]
}, Open  ]]
},
WindowSize->{1692, 2955},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) \
(2023\:5e747\:670824\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"79b969e7-9cf1-4516-b41a-58ea2c9dd37a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2697, 60, 140, "Input",ExpressionUUID->"7b87a041-f96b-476d-8e6e-c23284dd32f5"],
Cell[3280, 84, 1129, 18, 52, "Output",ExpressionUUID->"1a72f7c6-0ecd-4381-95e8-239cb35dfa57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4446, 107, 1586, 41, 140, "Input",ExpressionUUID->"a2a5b0ee-33c1-46d3-8514-41174862a17d"],
Cell[6035, 150, 7534, 208, 177, "Output",ExpressionUUID->"e9cff216-a5be-4f5a-8911-165f174653af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13606, 363, 1475, 29, 109, "Input",ExpressionUUID->"12315844-3022-4d7f-a2cc-128d4194ec79"],
Cell[15084, 394, 1036, 15, 52, "Output",ExpressionUUID->"18e57433-1cdd-4f96-bb11-0399f05ad62a"]
}, Open  ]],
Cell[16135, 412, 987, 25, 46, "Input",ExpressionUUID->"95fd2f0c-f392-46e8-9425-62453b95d61e"],
Cell[CellGroupData[{
Cell[17147, 441, 6020, 134, 525, "Input",ExpressionUUID->"21b1575e-f438-488f-82c7-6312b46261da"],
Cell[23170, 577, 1271, 17, 52, "Output",ExpressionUUID->"410f6d32-6482-490f-8815-50617ee048c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24478, 599, 6126, 152, 568, "Input",ExpressionUUID->"774be7df-8518-45ff-90de-903c14013348"],
Cell[30607, 753, 1249, 17, 52, "Output",ExpressionUUID->"02855c87-2b54-40dd-a688-2048a920fb9e"]
}, Open  ]],
Cell[31871, 773, 5430, 131, 524, "Input",ExpressionUUID->"8ee25b0e-d478-4213-b890-20fcc0b4e68e"],
Cell[CellGroupData[{
Cell[37326, 908, 3861, 114, 295, "Input",ExpressionUUID->"463018c0-a8df-425d-b261-a2a39e034346"],
Cell[41190, 1024, 765, 13, 101, "Output",ExpressionUUID->"04c39c98-b329-4af7-9a8f-89c3c8b65d5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41992, 1042, 522, 15, 78, "Input",ExpressionUUID->"6e94b03e-3d0d-4f47-b0ee-395796bc90d9"],
Cell[42517, 1059, 913, 15, 101, "Output",ExpressionUUID->"105210cb-624e-4e77-bee2-9cb7c40b3ce5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43467, 1079, 2033, 52, 140, "Input",ExpressionUUID->"ba0e7503-4848-4cfc-993b-7179c710558d"],
Cell[45503, 1133, 605, 11, 101, "Output",ExpressionUUID->"8a6c683c-37b6-4608-945a-4b981fc6adf3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46145, 1149, 523, 15, 78, "Input",ExpressionUUID->"e26ca78a-87d3-4ac2-b4bd-b20bfcba0809"],
Cell[46671, 1166, 918, 15, 101, "Output",ExpressionUUID->"257c8196-c266-44ff-9007-b2ee2c8225c4"]
}, Open  ]]
}
]
*)

