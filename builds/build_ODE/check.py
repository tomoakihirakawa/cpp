import numpy as np
import matplotlib.pyplot as plt

# 固有振動数
frequencies = [1.0001, 0.0313938, 0.0263263, 0.024027, 0.0227889,
               0.0220459, 0.0215649, 0.0179781, 0.00350052, 0.000272549]

# 振動形状（固有ベクトル）
mode_shapes = np.array([
    [0.999948, 0.00791186, 0.00461916, 0.00298756, 0.00208418,
     0.00153501, 0.00117702, 0.000930937, 0.00128887, 0.000738492],
    [-0.0101984, 0.76968, 0.4566, 0.296781, 0.207512,
     0.153026, 0.117429, 0.092925, 0.128734, 0.0738329],
    [9.99848e-05, -0.619228, 0.377014, 0.393124, 0.322327,
     0.256993, 0.206326, 0.16805, 0.240855, 0.14529],
    [-4.82019e-22, 0.155203, -0.760389, 0.0965381, 0.25682,
     0.266388, 0.240786, 0.209604, 0.322479, 0.213488],
    [0, -4.04556e-18, 0.266764, -0.788452, -0.0787151,
     0.134163, 0.193729, 0.200887, 0.358435, 0.276807]
])

# 各モードの振動形状をプロット
for i in range(len(mode_shapes)):
    plt.plot(range(1, len(mode_shapes[i]) + 1), mode_shapes[i], label=f"Mode {i+1}")

plt.xlabel("Node")
plt.ylabel("Mode Shape")
plt.title("Mode Shapes of the Beam")
plt.legend()
plt.grid(True)
plt.show()
