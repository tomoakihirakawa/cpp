(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25581,        759]
NotebookOptionsPosition[     24002,        726]
NotebookOutlinePosition[     24350,        741]
CellTagsIndexPosition[     24307,        738]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.904254118093151*^9, 3.9042541237710457`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"56012edb-2528-4775-a8fb-9aaaa370201d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", "[", 
   RowBox[{"axis_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "/", "2"}], "]"}], "*", 
       RowBox[{"Normalize", "[", "axis", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "q1", ",", "q2", ",", 
        "q3"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.904253502616699*^9, 3.9042535486611423`*^9}, {
  3.904253723660809*^9, 3.904253772106855*^9}, {3.9042538717216*^9, 
  3.9042538838799686`*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"815ec89a-85b8-46c8-b8f3-8222d2745af5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QQ", "[", 
   RowBox[{"QA_", ",", "QB_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a1", ",", "b1", ",", "c1", ",", "d1", ",", "a2", ",", "b2", ",", "c2", 
      ",", "d2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1", ",", "b1", ",", "c1", ",", "d1"}], "}"}], "=", "QA"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a2", ",", "b2", ",", "c2", ",", "d2"}], "}"}], "=", "QB"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"a1", "*", "a2"}], "+", 
         RowBox[{
          RowBox[{"-", "b1"}], "*", "b2"}], "+", 
         RowBox[{
          RowBox[{"-", "c1"}], "*", "c2"}], "+", 
         RowBox[{
          RowBox[{"-", "d1"}], "*", "d2"}]}], ",", 
        RowBox[{
         RowBox[{"a1", "*", "b2"}], "+", 
         RowBox[{"b1", "*", "a2"}], "+", 
         RowBox[{"c1", "*", "d2"}], "-", 
         RowBox[{"d1", "*", "c2"}]}], ",", 
        RowBox[{
         RowBox[{"a1", "*", "c2"}], "-", 
         RowBox[{"b1", "*", "d2"}], "+", 
         RowBox[{"c1", "*", "a2"}], "+", 
         RowBox[{"d1", "*", "b2"}]}], ",", 
        RowBox[{
         RowBox[{"a1", "*", "d2"}], "+", 
         RowBox[{"b1", "*", "c2"}], "-", 
         RowBox[{"c1", "*", "b2"}], "+", 
         RowBox[{"d1", "*", "a2"}]}]}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9042536182017727`*^9, 3.9042537077421503`*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"fc230184-e07c-4576-a743-6c528e5191e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wToQ", "[", "w_", "]"}], ":=", 
  RowBox[{"FullSimplify", "@", 
   RowBox[{"QQ", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"QQ", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"w", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"w", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Q", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"w", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.90425371509766*^9, 3.904253715815075*^9}, {
  3.9042537801274652`*^9, 3.9042538471666393`*^9}, {3.9042538933700943`*^9, 
  3.904253894931817*^9}, {3.9042539484176064`*^9, 3.904253988298167*^9}, {
  3.90425401925843*^9, 3.9042541138808403`*^9}, {3.904254273366341*^9, 
  3.904254285260365*^9}, {3.904254329003854*^9, 3.904254329578978*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"794f0594-d2fa-4d7e-ae3e-ea32a6d81a28"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q", "=", 
   RowBox[{"{", 
    RowBox[{"q0", ",", "q1", ",", "q2", ",", "q3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"QQ", "[", 
      RowBox[{
       RowBox[{"wToQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w0", ",", "w1", ",", "w2"}], "}"}], "*", "dt"}], "]"}], 
       ",", "q"}], "]"}], "-", "q"}], ")"}], "/", "dt"}], "]"}]}], "Input",
 CellChangeTimes->{{3.90425500549067*^9, 3.904255034257146*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"c7bee08f-8699-4d9a-8a8a-caf4d91c51ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "q0"}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"dt", " ", "w1"}], "2"], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q3", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q0", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q1"}], " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"dt", " ", "w1"}], "2"], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q1", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "-", 
           RowBox[{"q3", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], "dt"], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "q1"}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q3", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q0", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "-", 
           RowBox[{"q2", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"dt", " ", "w1"}], "2"], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q1", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "-", 
           RowBox[{"q3", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], "dt"], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "q2"}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"dt", " ", "w1"}], "2"], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q3", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q0", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "-", 
           RowBox[{"q2", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q1", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "-", 
           RowBox[{"q3", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], "dt"], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "q3"}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q3", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q0", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q1"}], " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "+", 
           RowBox[{"q1", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}], "-", 
           RowBox[{"q3", " ", 
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"dt", " ", "w2"}], "2"], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], "dt"]}], "}"}]], "Output",
 CellChangeTimes->{{3.904255404494869*^9, 3.9042554326237183`*^9}},
 CellLabel->
  "Out[305]=",ExpressionUUID->"b6f2d73f-080a-48ec-bc67-d67edfa0192a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"%", ",", 
   RowBox[{"dt", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.904255041759182*^9, 3.904255050560006*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"937de2a6-0702-4fbe-9aad-5f34d71496bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "q1"}], " ", "w0"}], "-", 
      RowBox[{"q2", " ", "w1"}], "-", 
      RowBox[{"q3", " ", "w2"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", "w0"}], "+", 
      RowBox[{"q3", " ", "w1"}], "-", 
      RowBox[{"q2", " ", "w2"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "q3"}], " ", "w0"}], "+", 
      RowBox[{"q0", " ", "w1"}], "+", 
      RowBox[{"q1", " ", "w2"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q2", " ", "w0"}], "-", 
      RowBox[{"q1", " ", "w1"}], "+", 
      RowBox[{"q0", " ", "w2"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.904255020359853*^9, 3.904255052964142*^9}, {
  3.9042554046296787`*^9, 3.90425543272237*^9}},
 CellLabel->
  "Out[306]=",ExpressionUUID->"f4717112-1525-4329-b136-a996d694124b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", "\[Rule]", "c0"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w0"}], "2"], "]"}], " ", "\[Rule]", "s0"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", "\[Rule]", "c1"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w1"}], "2"], "]"}], " ", "\[Rule]", "s1"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w2"}], "2"], "]"}], " ", "\[Rule]", "c2"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"dt", " ", "w2"}], "2"], "]"}], " ", "\[Rule]", "s2"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rep2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"c2", " ", "q0"}], "-", 
       RowBox[{"q3", " ", "s2"}]}], "\[Rule]", "F0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c2", " ", "q2"}], "+", 
       RowBox[{"q1", " ", "s2"}]}], "\[Rule]", "F1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c2", " ", "q3"}], "+", 
       RowBox[{"q0", " ", "s2"}]}], "\[Rule]", "F2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c2", " ", "q1"}], "-", 
       RowBox[{"q2", " ", "s2"}]}], "\[Rule]", "F3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rep3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", "q0"}], "+", 
       RowBox[{"q3", " ", "s2"}]}], "\[Rule]", 
      RowBox[{"-", "F0"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", "q2"}], "-", 
       RowBox[{"q1", " ", "s2"}]}], "\[Rule]", 
      RowBox[{"-", "F1"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", "q3"}], "-", 
       RowBox[{"q0", " ", "s2"}]}], "\[Rule]", 
      RowBox[{"-", "F2"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", "q1"}], "+", 
       RowBox[{"q2", " ", "s2"}]}], "\[Rule]", 
      RowBox[{"-", "F3"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Column", "@", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"wToQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"w0", ",", "w1", ",", "w2"}], "}"}], "*", "dt"}], "]"}], 
    "]"}]}], "/.", "rep"}]}], "Input",
 CellChangeTimes->{{3.904254416055347*^9, 3.90425444697338*^9}, {
  3.904254506402033*^9, 3.904254507985211*^9}, {3.9042545428285723`*^9, 
  3.904254577218606*^9}, {3.904254628869113*^9, 3.904254640387898*^9}, {
  3.9042554189678183`*^9, 3.904255419648409*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"3a0e8b88-bd06-4d0f-8ea4-f92ccc6dea72"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{"c0", " ", "c1", " ", "c2"}], "-", 
      RowBox[{"s0", " ", "s1", " ", "s2"}]}]},
    {
     RowBox[{
      RowBox[{"c1", " ", "c2", " ", "s0"}], "+", 
      RowBox[{"c0", " ", "s1", " ", "s2"}]}]},
    {
     RowBox[{
      RowBox[{"c0", " ", "c2", " ", "s1"}], "-", 
      RowBox[{"c1", " ", "s0", " ", "s2"}]}]},
    {
     RowBox[{
      RowBox[{"c2", " ", "s0", " ", "s1"}], "+", 
      RowBox[{"c0", " ", "c1", " ", "s2"}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.904254421486911*^9, 3.904254447421735*^9}, 
   3.904254508615954*^9, {3.904254556543138*^9, 3.904254580642263*^9}, {
   3.904254645320215*^9, 3.9042546560089083`*^9}, {3.90425471256673*^9, 
   3.904254778679573*^9}, {3.904254836917347*^9, 3.9042548523143044`*^9}, 
   3.9042548838146877`*^9, {3.904255404659713*^9, 3.904255432748667*^9}},
 CellLabel->
  "Out[310]=",ExpressionUUID->"e85ace48-30bd-4a6d-a388-39e7a39b722c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"QQ", "[", 
        RowBox[{
         RowBox[{"wToQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"w0", ",", "w1", ",", "w2"}], "}"}], "*", "dt"}], "]"}], 
         ",", "q"}], "]"}], "-", "q"}], ")"}], "/", "dt"}], "]"}], "/.", 
   "rep"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.904254142598466*^9, 3.9042542157963*^9}, {
   3.9042546435335693`*^9, 3.904254652547846*^9}, {3.904254707806847*^9, 
   3.904254777833454*^9}, {3.9042548209935017`*^9, 3.904254882962358*^9}, 
   3.904255032415083*^9, {3.904255417509077*^9, 
   3.904255454165895*^9}},ExpressionUUID->"658ae9e0-a30f-41f9-a7bd-\
36e5bebbec19"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "c0"}], " ", "c1", " ", "F0"}], "+", "q0", "+", 
      RowBox[{"c1", " ", "F3", " ", "s0"}], "+", 
      RowBox[{"c0", " ", "F1", " ", "s1"}], "+", 
      RowBox[{"F2", " ", "s0", " ", "s1"}]}], "dt"]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"c0", " ", "c1", " ", "F3"}], "-", "q1", "+", 
     RowBox[{"c1", " ", "F0", " ", "s0"}], "+", 
     RowBox[{"c0", " ", "F2", " ", "s1"}], "-", 
     RowBox[{"F1", " ", "s0", " ", "s1"}]}], "dt"], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"c0", " ", "c1", " ", "F1"}], "-", "q2", "-", 
     RowBox[{"c1", " ", "F2", " ", "s0"}], "+", 
     RowBox[{"c0", " ", "F0", " ", "s1"}], "+", 
     RowBox[{"F3", " ", "s0", " ", "s1"}]}], "dt"], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"c0", " ", "c1", " ", "F2"}], "-", "q3", "+", 
     RowBox[{"c1", " ", "F1", " ", "s0"}], "-", 
     RowBox[{"c0", " ", "F3", " ", "s1"}], "+", 
     RowBox[{"F0", " ", "s0", " ", "s1"}]}], "dt"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9042541893824043`*^9, 3.904254220731492*^9}, 
   3.9042543329147587`*^9, 3.904254409902574*^9, {3.904254645349945*^9, 
   3.904254656186009*^9}, {3.904254712593552*^9, 3.904254778737605*^9}, {
   3.904254836991725*^9, 3.9042548523453913`*^9}, 3.9042548838516493`*^9, {
   3.90425540498073*^9, 3.904255433054378*^9}},
 CellLabel->
  "Out[311]=",ExpressionUUID->"0367ca22-4e65-48f3-b8b3-740366fb6508"],

Cell["\<\
List(-((-(c0*c1*F0) + q0 + c1*F3*s0 + c0*F1*s1 + F2*s0*s1)/dt),(c0*c1*F3 - q1 \
+ c1*F0*s0 + c0*F2*s1 - F1*s0*s1)/dt,(c0*c1*F1 - q2 - c1*F2*s0 + c0*F0*s1 + \
F3*s0*s1)/dt,
   (c0*c1*F2 - q3 + c1*F1*s0 - c0*F3*s1 + F0*s0*s1)/dt)\
\>", "Output",
 CellChangeTimes->{{3.9042541893824043`*^9, 3.904254220731492*^9}, 
   3.9042543329147587`*^9, 3.904254409902574*^9, {3.904254645349945*^9, 
   3.904254656186009*^9}, {3.904254712593552*^9, 3.904254778737605*^9}, {
   3.904254836991725*^9, 3.9042548523453913`*^9}, 3.9042548838516493`*^9, {
   3.90425540498073*^9, 3.904255433056024*^9}},
 CellLabel->
  "Out[312]//CForm=",ExpressionUUID->"e969568c-5f2e-4566-afeb-33ce6b5fd506"]
}, Open  ]]
},
WindowSize->{1728, 1051},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (2019\:5e745\:67083\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 227, 4, 30, "Input",ExpressionUUID->"56012edb-2528-4775-a8fb-9aaaa370201d"],
Cell[788, 26, 1041, 29, 94, "Input",ExpressionUUID->"815ec89a-85b8-46c8-b8f3-8222d2745af5"],
Cell[1832, 57, 1706, 48, 115, "Input",ExpressionUUID->"fc230184-e07c-4576-a743-6c528e5191e8"],
Cell[3541, 107, 1410, 34, 157, "Input",ExpressionUUID->"794f0594-d2fa-4d7e-ae3e-ea32a6d81a28"],
Cell[CellGroupData[{
Cell[4976, 145, 639, 19, 52, "Input",ExpressionUUID->"c7bee08f-8699-4d9a-8a8a-caf4d91c51ba"],
Cell[5618, 166, 9748, 303, 206, "Output",ExpressionUUID->"b6f2d73f-080a-48ec-bc67-d67edfa0192a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15403, 474, 261, 6, 30, "Input",ExpressionUUID->"937de2a6-0702-4fbe-9aad-5f34d71496bc"],
Cell[15667, 482, 1118, 36, 50, "Output",ExpressionUUID->"f4717112-1525-4329-b136-a996d694124b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16822, 523, 2965, 92, 113, "Input",ExpressionUUID->"3a0e8b88-bd06-4d0f-8ea4-f92ccc6dea72"],
Cell[19790, 617, 1125, 29, 83, "Output",ExpressionUUID->"e85ace48-30bd-4a6d-a388-39e7a39b722c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20952, 651, 843, 21, 52, "Input",ExpressionUUID->"658ae9e0-a30f-41f9-a7bd-36e5bebbec19"],
Cell[21798, 674, 1503, 35, 51, "Output",ExpressionUUID->"0367ca22-4e65-48f3-b8b3-740366fb6508"],
Cell[23304, 711, 682, 12, 63, "Output",ExpressionUUID->"e969568c-5f2e-4566-afeb-33ce6b5fd506"]
}, Open  ]]
}
]
*)

