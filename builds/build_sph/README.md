# Contents

- [ğŸ‹ Smoothed Particle Hydrodynamics (SPH) ISPH EISPH](#ğŸ‹-Smoothed-Particle-Hydrodynamics-(SPH)-ISPH-EISPH)
    - [â›µ æ¦‚è¦](#â›µ-æ¦‚è¦)
        - [ğŸª¼ è¦ç´ æ³•ã¨ç²’å­æ³•](#ğŸª¼-è¦ç´ æ³•ã¨ç²’å­æ³•)
        - [ğŸª¼ SPH](#ğŸª¼-SPH)
        - [ğŸª¼ ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç›®çš„](#ğŸª¼-ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç›®çš„)
        - [ğŸª¼ å¤§ã¾ã‹ãªè¨ˆç®—ã®æµã‚Œ](#ğŸª¼-å¤§ã¾ã‹ãªè¨ˆç®—ã®æµã‚Œ)
            - [ğŸš Navier-Stokesæ–¹ç¨‹å¼ã‚’è§£ãå‰ã®æº–å‚™](#ğŸš-Navier-Stokesæ–¹ç¨‹å¼ã‚’è§£ãå‰ã®æº–å‚™)
            - [ğŸš Navier-Stokesæ–¹ç¨‹å¼ã‚’è§£ã](#ğŸš-Navier-Stokesæ–¹ç¨‹å¼ã‚’è§£ã)
        - [ğŸª¼ CFLæ¡ä»¶ã®è¨­å®š](#ğŸª¼-CFLæ¡ä»¶ã®è¨­å®š)
    - [â›µ è¨ˆç®—ã«åˆ©ç”¨ã™ã‚‹å£é¢ç²’å­ã ã‘ã‚’æŠ½å‡º](#â›µ-è¨ˆç®—ã«åˆ©ç”¨ã™ã‚‹å£é¢ç²’å­ã ã‘ã‚’æŠ½å‡º)
    - [â›µ å£é¢ç²’å­ã®æµé€Ÿã®æ±ºå®š](#â›µ-å£é¢ç²’å­ã®æµé€Ÿã®æ±ºå®š)
        - [ğŸª¼ å‹¾é…æ¼”ç®—å­ã®ä¿®æ­£ã‚’ã™ã‚‹è¡Œåˆ—ã®è¨ˆç®—](#ğŸª¼-å‹¾é…æ¼”ç®—å­ã®ä¿®æ­£ã‚’ã™ã‚‹è¡Œåˆ—ã®è¨ˆç®—)
    - [â›µ æµä½“ã®æ³•ç·šæ–¹å‘ã®è¨ˆç®—ã¨æ°´é¢ã®åˆ¤å®š](#â›µ-æµä½“ã®æ³•ç·šæ–¹å‘ã®è¨ˆç®—ã¨æ°´é¢ã®åˆ¤å®š)
        - [ğŸª¼ æµä½“ã®æ³•ç·šæ–¹å‘ã®è¨ˆç®—](#ğŸª¼-æµä½“ã®æ³•ç·šæ–¹å‘ã®è¨ˆç®—)
        - [ğŸª¼ æ°´é¢ã®åˆ¤å®š](#ğŸª¼-æ°´é¢ã®åˆ¤å®š)
    - [â›µ ç²˜æ€§é …$`\nabla^2 {\bf u} _i`$ã®è¨ˆç®—ï¼ˆ`calcLaplacianU`ï¼‰](#â›µ-ç²˜æ€§é …$`\nabla^2-{\bf-u}-_i`$ã®è¨ˆç®—ï¼ˆ`calcLaplacianU`ï¼‰)
    - [â›µ ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼$`\nabla^{n+1} \cdot \left(\frac{1}{\rho^n} \nabla^{n} p^{n+1}\right) = b`$](#â›µ-ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼$`\nabla^{n+1}-\cdot-\left(\frac{1}{\rho^n}-\nabla^{n}-p^{n+1}\right)-=-b`$)
        - [ğŸª¼ ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼](#ğŸª¼-ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼)
        - [ğŸª¼ å³è¾ºï¼Œ$`b`$ï¼Œ`PoissonRHS`ã«ã¤ã„ã¦](#ğŸª¼-å³è¾ºï¼Œ$`b`$ï¼Œ`PoissonRHS`ã«ã¤ã„ã¦)
        - [ğŸª¼ å·¦è¾ºã«ã¤ã„ã¦](#ğŸª¼-å·¦è¾ºã«ã¤ã„ã¦)
        - [ğŸª¼ æ°´é¢ã®è¨ˆç®—è£œåŠ©ç²’å­`auxiliaryPoints`](#ğŸª¼-æ°´é¢ã®è¨ˆç®—è£œåŠ©ç²’å­`auxiliaryPoints`)
        - [ğŸª¼ æ¬¡æ™‚åˆ»ã®ç™ºæ•£æ¼”ç®—ï¼Œ$`\nabla^{n+1} \cdot {\bf b}^n = \sum _j \dfrac{m _j}{\rho _j^{n+1}}({\bf b} _j^n-{\bf b} _i^n)\cdot \nabla W({\bf x} _i^{n+1},{\bf x} _j^{n+1},h)`$](#ğŸª¼-æ¬¡æ™‚åˆ»ã®ç™ºæ•£æ¼”ç®—ï¼Œ$`\nabla^{n+1}-\cdot-{\bf-b}^n-=-\sum-_j-\dfrac{m-_j}{\rho-_j^{n+1}}({\bf-b}-_j^n-{\bf-b}-_i^n)\cdot-\nabla-W({\bf-x}-_i^{n+1},{\bf-x}-_j^{n+1},h)`$)
    - [â›µ ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼ã®è§£æ³•](#â›µ-ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼ã®è§£æ³•)
    - [â›µ åœ§åŠ›å‹¾é…$`\nabla p^{n+1}`$ã®è¨ˆç®—](#â›µ-åœ§åŠ›å‹¾é…$`\nabla-p^{n+1}`$ã®è¨ˆç®—)
    - [â›µ æ³¨æ„ç‚¹](#â›µ-æ³¨æ„ç‚¹)
- [ğŸ‹ å®Ÿè¡Œæ–¹æ³•](#ğŸ‹-å®Ÿè¡Œæ–¹æ³•)
- [ğŸ‹ Bucketã‚’ç”¨ã„ãŸç²’å­æ¢ç´¢ã®ãƒ†ã‚¹ãƒˆ](#ğŸ‹-Bucketã‚’ç”¨ã„ãŸç²’å­æ¢ç´¢ã®ãƒ†ã‚¹ãƒˆ)
- [ğŸ‹ ãƒ†ã‚¹ãƒˆ](#ğŸ‹-ãƒ†ã‚¹ãƒˆ)
    - [â›µ æ ¸é–¢æ•°ã®ãƒ†ã‚¹ãƒˆ](#â›µ-æ ¸é–¢æ•°ã®ãƒ†ã‚¹ãƒˆ)


---
# ğŸ‹ Smoothed Particle Hydrodynamics (SPH) ISPH EISPH 

## â›µ æ¦‚è¦ 

### ğŸª¼ è¦ç´ æ³•ã¨ç²’å­æ³• 

æœ‰é™è¦ç´ æ³•ã‚„å¢ƒç•Œè¦ç´ æ³•ãªã©ï¼Œ
è¦ç´ ã‚’åˆ©ç”¨ã™ã‚‹è¨ˆç®—æ‰‹æ³•ã¯ï¼Œ
ç¯€ç‚¹ã®æ¥ç¶šã«åŸºã¥ãè¦ç´ ã‚’æ§‹æˆã—ï¼ˆè£œé–“ï¼‰ï¼Œ
å¾®åˆ†æ–¹ç¨‹å¼ã‚’é›¢æ•£åŒ–ã—ã¦è§£ãï¼
åŸºæœ¬çš„ã«ã¯ï¼Œè¦ç´ ãŒæ­ªã«ãªã‚‹ã¨è¨ˆç®—ãŒã§ããªã„ï¼
ã¾ãŸï¼Œä¸Šæ‰‹ã«è¦ç´ ã‚’å†æ§‹æˆã™ã‚‹ã®ã¯å¤§å¤‰ã§ã‚ã‚‹ï¼

ä¸€æ–¹ã®ç²’å­æ³•ã¯ï¼Œç¯€ç‚¹é–“ã«ãªã‚“ã‚‰æ±ºã¾ã£ãŸï¼ˆè¦ç´ ã®æ§˜ãªï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¦æ±‚ã›ãšï¼Œå†æ§‹æˆã¨ã„ã†æ¦‚å¿µãŒãªã„ï¼
ãã‚Œã„ã«æ•´åˆ—ã—ãŸç²’å­ã®æ–¹ãŒè¨ˆç®—ç²¾åº¦ã¯é«˜ã„ãŒï¼Œä¹±ã‚ŒãŸã¨ã—ã¦ã‚‚è¨ˆç®—ã¯ã§ãã‚‹ï¼

### ğŸª¼ SPH 

ç²’å­æ³•ã«ã¯ä¸»ã«ï¼’ã¤ã®ç¨®é¡ãŒã‚ã‚‹ï¼
ä¸€ã¤ã¯ï¼Œè¶Šå¡šã‚‰ã«ã‚ˆã£ã¦ææ¡ˆã•ã‚ŒãŸMoving Particle Semi-implicit (MPS)æ³•ã§ã‚ã‚Šï¼Œ
ã‚‚ã†ä¸€ã¤ã¯ï¼Œ[Gingold and Monaghan (1977)](https://academic.oup.com/mnras/article-lookup/doi/10.1093/mnras/181.3.375)ã¨[Lucy (1977)](http://adsabs.harvard.edu/cgi-bin/bib_query?1977AJ.....82.1013L)ã«ã‚ˆã£ã¦ææ¡ˆã•ã‚ŒãŸSmoothed Particle Hydrodynamics (SPH)æ³•ã§ã‚ã‚‹ï¼
ä¸–ç•Œçš„ã«ã¯SPHæ³•ãŒã‚ˆãä½¿ã‚ã‚Œã¦ã„ã‚‹ï¼

SPHã®ç ”ç©¶è€…ãŠã‚ˆã³ç”£æ¥­ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰æˆã‚‹[SPHETIC](https://www.spheric-sph.org/sph-projects-and-codes)ã¨ã„ã†ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãŒã‚ã‚‹ï¼
ãã‚Œã«ã‚ˆã‚‹ã¨SPHã¯ï¼Œ1970å¹´ä»£ã«å¤©ä½“ç‰©ç†å­¦ã«ãŠã‘ã‚‹éè»¸å¯¾ç§°ãªç¾è±¡ã‚’ç ”ç©¶ã™ã‚‹ãŸã‚ã«é–‹ç™ºã•ã‚Œï¼Œ
ãã®å·¥å­¦ã¸ã®å¿œç”¨ã¯1990å¹´ä»£ã¨2000å¹´ä»£åˆé ­ã«ç™»å ´ã—ãŸï¼
éå»äºŒåå¹´ã§ã€ã“ã®æ‰‹æ³•ã¯å¤šãã®å¿œç”¨åˆ†é‡ã§æ€¥é€Ÿã«ç™ºå±•ã—ã¦ãŠã‚Šã€
è¡çªã‹ã‚‰ç ´å£Šï¼Œæ°´é¢æ³¢ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼Œæµä½“-æ§‹é€ ç›¸äº’ä½œç”¨ã«è‡³ã‚‹ã¾ã§å¤šå²ã«ã‚ãŸã£ã¦ã„ã‚‹ï¼

### ğŸª¼ ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç›®çš„ 

ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ï¼Œ
ISPHã¨ISPHã‚’ç°¡å˜åŒ–ã—ãŸEISPHã‚’å®Ÿè£…ã—ãŸã‚‚ã®ã§ã‚ã‚‹ï¼
ã¾ãšã¯ï¼Œä¸å®‰è¦ç´ ãŒå°‘ãªã„ISPHã§å®‰å®šã—ãŸè¨ˆç®—æ–¹æ³•ã‚’ç¢ºç«‹ã—ï¼Œ
ãã®å¾Œï¼ŒEISPHã¸ã¨ç§»è¡Œã™ã‚‹ï¼

### ğŸª¼ å¤§ã¾ã‹ãªè¨ˆç®—ã®æµã‚Œ 

ã“ã®SPHã§ã¯ï¼Œéåœ§ç¸®æ€§æµä½“ã®ãƒŠãƒ“ã‚¨ãƒ»ã‚¹ãƒˆãƒ¼ã‚¯ã‚¹æ–¹ç¨‹å¼ã‚’è§£ãï¼

```math
\frac{D\bf u}{Dt} = -\frac{1}{\rho}\nabla {p} + \nu\nabla^2{\bf u} + {\bf g},\quad  \nu=\frac{\mu}{\rho}
```

#### ğŸš Navier-Stokesæ–¹ç¨‹å¼ã‚’è§£ãå‰ã®æº–å‚™ 

1. ãƒã‚±ãƒƒãƒˆã®ç”Ÿæˆ
2. æµã‚Œã®è¨ˆç®—ã«é–¢ä¸ã™ã‚‹å£ç²’å­ã‚’ä¿å­˜
3. CFLæ¡ä»¶ã‚’æº€ãŸã™ã‚ˆã†ã«ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—é–“éš” $`\Delta t`$ã‚’è¨­å®š
4. æ°´é¢ã®åˆ¤å®š

#### ğŸš Navier-Stokesæ–¹ç¨‹å¼ã‚’è§£ã 

5. $`\nabla^2 {\bf u}`$ã®è¨ˆç®—
6. `PoissonRHS`,$`b`$ã¨$`\nabla^2 p^{n+1}`$ã«ãŠã‘ã‚‹$`p^{n+1}`$ã®ä¿‚æ•°ã®è¨ˆç®—
7. æµé€Ÿã®ç™ºæ•£ã‹ã‚‰å¯†åº¦ $`{\rho}^\ast`$ã‚’è¨ˆç®—
8. æ¬¡ã®æ™‚åˆ»ã®åœ§åŠ› $`p^{n+1}`$ã‚’è¨ˆç®—
* å£ç²’å­ã®åœ§åŠ›ã®è¨ˆç®—ï¼ˆæµä½“ç²’å­ã®ç¾åœ¨ã®åœ§åŠ›$`p^n`$ã ã‘ã‚’ä½¿ã£ã¦è¿‘ä¼¼ï¼‰
* æµä½“ç²’å­ã®åœ§åŠ›$`p^{n+1}`$ã®è¨ˆç®—
9. $`\nabla {p^{n+1}}`$ãŒè¨ˆç®—ã§ãï¼Œ $`\frac{D{\bf u}}{D t}=-\frac{1}{\rho}\nabla {p^{n+1}} + \frac{1}{\nu}\nabla^2{\bf u} + {\bf g}`$ï¼ˆç²˜æ€§ç‡ãŒä¸€å®šã®éåœ§ç¸®æ€§æµã‚Œã®åŠ é€Ÿåº¦ï¼‰ã‚’å¾—ã‚‹ï¼
10. $`\frac{D\bf u}{Dt}`$ã‚’ä½¿ã£ã¦ï¼Œæµé€Ÿã‚’æ›´æ–°ï¼æµé€Ÿã‚’ä½¿ã£ã¦ä½ç½®ã‚’æ›´æ–°


[./SPH.hpp#L210](./SPH.hpp#L210)


---
### ğŸª¼ CFLæ¡ä»¶ã®è¨­å®š 

$`\max({\bf u}) \Delta t \leq c _{v} h \cap \max({\bf a}) \Delta t^2 \leq c _{a} h`$
ã‚’æº€ãŸã™ã‚ˆã†ã«ï¼Œæ¯æ™‚åˆ»$`\Delta t`$ã‚’è¨­å®šã™ã‚‹ï¼


[./SPH_Functions.hpp#L90](./SPH_Functions.hpp#L90)


---
## â›µ è¨ˆç®—ã«åˆ©ç”¨ã™ã‚‹å£é¢ç²’å­ã ã‘ã‚’æŠ½å‡º 

æµä½“ç²’å­ã¨åŒã˜å½±éŸ¿åŠå¾„ã‚’ä½¿ã£ã¦ã—ã¾ã†ã¨ï¼Œæµä½“ç²’å­ãŒå‚ç…§ã§ãã‚‹ç¯„å›²ã‚®ãƒªã‚®ãƒªã«ã‚ã‚‹å£ç²’å­ã®æ³•ç·šæ–¹å‘ã®å€¤ãŒä¸æ­£ç¢ºã«ãªã‚‹ï¼
ãã®ãŸã‚ï¼Œæµä½“ç²’å­ã®å½±éŸ¿åŠå¾„ã‚ˆã‚Šã‚‚åºƒã„åŠå¾„ã‚’ä½¿ã£ã¦ï¼Œ`q->interp_normal_original`ã®æ³•ç·šæ–¹å‘ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒï¼Œé‡è¦ã§ã‚ã‚‹ï¼


[./SPH0_setWall_Freesurface.hpp#L273](./SPH0_setWall_Freesurface.hpp#L273)


## â›µ å£é¢ç²’å­ã®æµé€Ÿã®æ±ºå®š 

å£ç²’å­ã®æµé€Ÿã‚’æµä½“ç²’å­ã®æµé€Ÿã«å¿œã˜ã¦å¤‰åŒ–ã•ã›ã‚‹ã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒç…©é›‘ã«ãªã‚‹ã®ã§ï¼Œ
**ã“ã“ã§ã¯**å£é¢ç²’å­ã®æµé€Ÿã¯å¸¸ã«ã‚¼ãƒ­ã«è¨­å®šã™ã‚‹ã“ã¨ã«ã™ã‚‹ï¼
å£ç²’å­ã®åœ§åŠ›ã¯ï¼Œæ°´ãŒåœ§ç¸®ã—ãªã„ã‚ˆã†ã«å„ã‚¹ãƒ†ãƒƒãƒ—æ¯ã«è¨ˆç®—ã—ç›´ã™å¿…è¦ãŒã‚ã‚‹ï¼

**ãƒ•ãƒªãƒ¼ã‚¹ãƒªãƒƒãƒ—æ¡ä»¶ã®è¨­å®š**

[ãƒ•ãƒªãƒ¼ã‚¹ãƒªãƒƒãƒ—æ¡ä»¶ã®è¨­å®š](not found)

| boolianå¤‰æ•° | æ„å‘³ |
|:---:|:---:|
|`isSurface` | æ°´é¢ã‹ã©ã†ã‹ |
|`isCaptured` | è¨ˆç®—ã§ç”¨ã„ã‚‹ã‹ã©ã†ã‹ |


[./SPH0_setWall_Freesurface.hpp#L320](./SPH0_setWall_Freesurface.hpp#L320)


---
### ğŸª¼ å‹¾é…æ¼”ç®—å­ã®ä¿®æ­£ã‚’ã™ã‚‹è¡Œåˆ—ã®è¨ˆç®— 

[Morikawa et al. (2023)](https://doi.org/10.1016/j.jcpx.2023.100125)ã§ç´¹ä»‹ã•ã‚Œã¦ã„ãŸï¼ŒRandles and Libersky (1996)ã®å‹¾é…æ¼”ç®—ã®ç²¾åº¦ã‚’æ”¹å–„ã™ã‚‹è¡Œåˆ—ã‚’è¨ˆç®—ã™ã‚‹ï¼
`grad_corr_M`ã¨ã—ã¦ã„ã‚‹ï¼

```math
\begin{align}
{\bf M} = \left(\sum _j V _j ({\bf x} _j-{\bf x} _i) \otimes \nabla W _{ij}\right)^{-1}
\end{align}
```


[./SPH0_setWall_Freesurface.hpp#L11](./SPH0_setWall_Freesurface.hpp#L11)


## â›µ æµä½“ã®æ³•ç·šæ–¹å‘ã®è¨ˆç®—ã¨æ°´é¢ã®åˆ¤å®š


[./SPH0_setWall_Freesurface.hpp#L375](./SPH0_setWall_Freesurface.hpp#L375)


### ğŸª¼ æµä½“ã®æ³•ç·šæ–¹å‘ã®è¨ˆç®— 

âœ… [å˜ä½æ³•ç·šãƒ™ã‚¯ãƒˆãƒ«](../../builds/build_sph/SPH0_setWall_Freesurface.hpp#L494): $`{\bf n} _i = {\rm Normalize}\left(-\sum _j {\frac{m _j}{\rho _j} \nabla W _{ij} }\right)`$

å˜ä½æ³•ç·šãƒ™ã‚¯ãƒˆãƒ«ã¯ï¼Œ`interp_normal`ã¨ã—ã¦ã„ã‚‹ï¼


[./SPH0_setWall_Freesurface.hpp#L406](./SPH0_setWall_Freesurface.hpp#L406)


### ğŸª¼ æ°´é¢ã®åˆ¤å®š 

`surface_condition0,1`ã®ä¸¡æ–¹ã‚’æº€ãŸã™å ´åˆï¼Œæ°´é¢ã¨ã™ã‚‹ï¼


[./SPH0_setWall_Freesurface.hpp#L515](./SPH0_setWall_Freesurface.hpp#L515)


---
## â›µ ç²˜æ€§é …$`\nabla^2 {\bf u} _i`$ã®è¨ˆç®—ï¼ˆ`calcLaplacianU`ï¼‰ 

<img src="icons/SELECTED.png" alt="SELECTED" style="width: 1em;"> [æµé€Ÿã®ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH1_lap_div_U.hpp#L44): $`\nabla^2 {\bf u} _i=\sum _{j} A _{ij}({\bf u} _i - {\bf u} _j),\quad A _{ij} = \frac{2m _j}{\rho _i}\frac{{{\bf x} _{ij}}\cdot\nabla W _{ij}}{{\bf x} _{ij}^2}`$

<img src="icons/SELECTED.png" alt="SELECTED" style="width: 1em;"> [æµé€Ÿã®ç™ºæ•£ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH1_lap_div_U.hpp#L40): $`\nabla\cdot{\bf u} _i=\sum _{j}\frac{m _j}{\rho _j}({{\bf u} _j-{\bf u} _i}) \cdot\nabla W _{ij}`$


[./SPH1_lap_div_U.hpp#L7](./SPH1_lap_div_U.hpp#L7)


---
## â›µ ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼$`\nabla^{n+1} \cdot \left(\frac{1}{\rho^n} \nabla^{n} p^{n+1}\right) = b`$ 

### ğŸª¼ ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼ 

æ¬¡ã®æ™‚åˆ»ã®æµã‚Œå ´ã‚’ç™ºæ•£ãªã—$`\nabla\cdot{\bf u}^{n+1}=0`$ã¨ã—ã¦ãã‚Œã‚‹
$`\frac{D {\bf u}}{D t} =-\frac{1}{\rho} \nabla p^{n+1}+\nu \nabla^2 {\bf u}^n+{\bf g}`$ã‚’ä½¿ã£ã¦ï¼Œæµé€Ÿã¨ç²’å­ä½ç½®ã‚’æ™‚é–“ç™ºå±•ã•ã›ãŸã„ï¼
ãã®ãŸã‚ã«ã¯ï¼Œåœ§åŠ›$`p^{n+1}`$ã‚’é©åˆ‡ã«æ±ºã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼

$`\frac{D {\bf u}}{D t}`$ã¯ï¼$`\frac{{\bf u}^{n+1} - {\bf u}^{n}}{\Delta t}`$ã¨é›¢æ•£åŒ–ã—æ¡ä»¶ã‚’è€ƒãˆã¦ã¿ã‚‹ï¼

```math
\frac{{\bf u}^{n+1} - {\bf u}^{n}}{\Delta t} =-\frac{1}{\rho} \nabla p^{n+1}+\nu \nabla^2 {\bf u}^n+{\bf g}
```

æ¬¡æ™‚åˆ»ã®ç™ºæ•£ã®æ¼”ç®—ã¯ï¼Œæ¬¡æ™‚åˆ»ã«ãŠã‘ã‚‹ç²’å­é…ç½®ã«åŸºã¥ãè¡Œã‚ã‚Œã‚‹ã®ã§ï¼Œç¾åœ¨ã®ç²’å­é…ç½®ã«åŸºã¥ãç™ºæ•£æ¼”ç®—ã¨ã¯åŒºåˆ¥ã™ã¹ãã§ã‚ã‚‹ï¼
ç¾åœ¨ã®å¾®åˆ†æ¼”ç®—ã‚’$`\nabla^{n}`$ã¨ã—ï¼Œæ¬¡æ™‚åˆ»ã®å¾®åˆ†æ¼”ç®—ã‚’$`\nabla^{n+1}`$ã¨ã™ã‚‹ï¼
$`\nabla^{n+1}`$ã‚’ä¸Šã®å¼ã«ä½œç”¨ã•ã›ã‚‹ã¨ï¼Œ

```math
\nabla^{n+1}\cdot {\bf u}^{n+1} = \nabla^{n+1} \cdot{\bf u}^{n} - \Delta t \nabla^{n+1} \cdot\left(\frac{1}{\rho} \nabla^{n} p^{n+1}-\nu \nabla^{n2} {\bf u}^n-{\bf g}\right)
```

å³è¾ºãŒã‚¼ãƒ­ã¨ãªã‚Œã°ï¼Œæ¬¡æ™‚åˆ»ã®æµé€Ÿã®ç™ºæ•£ãŒã‚¼ãƒ­ï¼Œ$`\nabla^{n+1}{\bf u}^{n+1}=0`$ã«ãªã‚‹ï¼š

```math
\begin{align*}
&&0 &= \nabla^{n+1} \cdot{\bf u}^{n} - \Delta t \nabla^{n+1} \cdot\left(\frac{1}{\rho} \nabla^{n} p^{n+1}-\nu \nabla^{n2} {\bf u}^n-{\bf g}\right)\\
&\rightarrow&\nabla^{n+1} \cdot \left(\frac{1}{\rho^n} \nabla^{n} p^{n+1}\right) &= \frac{1}{\Delta t}\nabla^{n+1} \cdot{\bf u}^{n} + \nabla^{n+1} \cdot\left(\nu^n \nabla^{n2} {\bf u}^n  + {\bf g}\right)\\
&\rightarrow& \nabla^{n+1} \cdot \left(\frac{1}{\rho^n} \nabla^{n} p^{n+1}\right) &= \nabla^{n+1} \cdot\left(\frac{1}{\Delta t}{\bf u}^{n} +\nu^n \nabla^{n2} {\bf u}^n  + {\bf g}\right)\\
&\rightarrow& \nabla^{n+1} \cdot \left(\frac{1}{\rho^n} \nabla^{n} p^{n+1}\right) &= b = \nabla^{n+1} \cdot {\bf b}^n,\quad  {\bf b}^n=\frac{1}{\Delta t}{\bf u}^{n} +\nu^n \nabla^{n2} {\bf u}^n
\end{align*}
```

é‡åŠ›ã®ç™ºæ•£ã¯ã‚¼ãƒ­ãªã®ã§æ¶ˆã—ãŸï¼

### ğŸª¼ å³è¾ºï¼Œ$`b`$ï¼Œ`PoissonRHS`ã«ã¤ã„ã¦ 

ã“ã®$`b`$ã‚’`PoissonRHS`ã¨ã™ã‚‹ï¼ï¼ˆä»®æµé€Ÿã¯$`{\bf u}^\ast = \frac{\Delta t}{\rho}{\bf b}^n`$ã¨åŒã˜ï¼‰ï¼
$`{\bf b}^n`$ ï¼ˆ[`Poisson_b_vector`](../../builds/build_sph/SPH1_lap_div_U.hpp#L69)ï¼‰ãŒè¨ˆç®—ã§ãã‚‹ã‚ˆã†ã«ï¼Œ$`{\bf u}^n`$ã¨$`\nabla^2 {\bf u}^n`$ã‚’è¨ˆç®—ã—ã¦ãŠãï¼

âœ… [ç™ºæ•£ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH2_FindPressure.hpp#L199): $`b=\nabla\cdot{\bf b}^n=\sum _{j}\frac{m _j}{\rho _j}({\bf b} _j^n-{\bf b} _i^n)\cdot\nabla W _{ij}`$

### ğŸª¼ å·¦è¾ºã«ã¤ã„ã¦ 

å£ç²’å­ã®åœ§åŠ›ã¯æ™‚é–“ç©åˆ†ã—ã¦è¨ˆç®—ã—ãªã„ã®ã§ï¼Œæ¯æ™‚åˆ»ï¼Œå£ç²’å­ã®$`p^{n+1}`$ã‚’è¨ˆç®—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼

âœ… [ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH2_FindPressure.hpp#L193): $`\nabla^2 p^{n+1}=\sum _{j}A _{ij}(p _i^{n+1} - p _j^{n+1}),\quad A _{ij} = \frac{2m _j}{\rho _i}\frac{{{\bf x} _{ij}}\cdot\nabla W _{ij}}{{\bf x} _{ij}^2}`$

âœ… [ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH1_lap_div_U.hpp#L48): $`\nabla^2 p^{n+1}=\sum _{j}A _{ij}(p _i^{n+1} - p _j^{n+1}),\quad A _{ij} = \frac{8 m _j\rho _i}{(\rho _i+\rho _j)^2}\frac{{{\bf x} _{ij}}\cdot\nabla W _{ij}}{{\bf x} _{ij}^2}`$

âš ï¸ å¯†åº¦$\rho$ãŒç²’å­ã«é–¢ã‚ã‚‰ãšä¸€å®šã®å ´åˆï¼Œä¸Šã®ï¼’å¼ã¯åŒã˜ã«ãªã‚‹ï¼ã—ã‹ã—ï¼Œè£œåŠ©ç²’å­ã®å¯†åº¦ã¯ï¼Œä»–ã®ç²’å­ã¨ç•°ãªã‚‹ã®ã§ï¼Œ[ï¼’ã¤ç›®ã®ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH1_lap_div_U.hpp#L48)ã‚’ä½¿ã†ã¹ãã ã‚ã†ï¼

**ISPH**

- ISPHã¯ä½œã£ãŸãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼ã‚’ä½œæˆã—è§£ãã“ã¨ã§åœ§åŠ›ã‚’è¨ˆç®—ã™ã‚‹

**EISPH**

1. å£ç²’å­ã®åœ§åŠ›ã®è¨ˆç®—ï¼ˆæµä½“ç²’å­ã®ç¾åœ¨ã®åœ§åŠ›$`p^n`$ã ã‘ã‚’ä½¿ã£ã¦è¿‘ä¼¼ï¼‰
2. æµä½“ç²’å­ã®åœ§åŠ›$`p^{n+1}`$ã®è¨ˆç®—

[EISPHã®åœ§åŠ›ã®è¨­å®šæ–¹æ³•](../../builds/build_sph/SPH2_FindPressure.hpp#L209)


$\sum _j A _{ij} (p _i^{n+1}-p _j^{n+1}) = b$ã«ãŠã„ã¦ï¼Œ$p _j^{n+1} \approx p _j^{n}$ã¨ã™ã‚‹ã¨ï¼Œ

```math
p _i^{n+1} = \frac{b + \sum _j A _{ij} p _j^{n}}{\sum _j A _{ij}}
```

ã¨ãªã‚‹ï¼

### ğŸª¼ æ°´é¢ã®è¨ˆç®—è£œåŠ©ç²’å­`auxiliaryPoints` 

æ°´é¢ã«ãŠã„ã¦ã¯ï¼Œæµé€Ÿã®ç™ºæ•£ã‚¼ãƒ­$`\nabla^{n+1} {\bf u}^{n+1}=0`$ã¨$`p^{n+1}=0`$ãŒæº€ãŸã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ï¼
æ°´é¢å¤–éƒ¨ã«ã¯ï¼Œç²’å­ãŒãªã„ã®ã§ï¼Œæ±‚ã‚ãŸæ°´é¢åœ§åŠ›ã¯ï¼Œã‚¼ãƒ­ã§ã‚ã£ã¦ã‚‚ï¼Œåœ§åŠ›å‹¾é…ã¯èª¤å·®ã‚’å«ã¿ï¼Œ$`\nabla^{n+1} {\bf u}^{n+1}=0`$ã¯æº€è¶³ã•ã‚Œãªã„ï¼
ãã“ã§ï¼Œ[æ°´é¢ã®è¨ˆç®—è£œåŠ©ç²’å­](../../include/Network.hpp#L492)ã‚’æ°´é¢å¤–éƒ¨ã«è¿½åŠ ã—ï¼Œã“ã®ç‚¹ã‚’é©åˆ‡è¨ˆç®—ã™ã‚‹ã“ã¨ã§ï¼Œ$`\nabla^{n+1} {\bf u}^{n+1}=0`$ãŒæº€è¶³ã•ã‚Œã‚‹ã‚ˆã†ã«å·¥å¤«ã™ã‚‹ï¼


[./SPH2_FindPressure.hpp#L7](./SPH2_FindPressure.hpp#L7)


---
### ğŸª¼ æ¬¡æ™‚åˆ»ã®ç™ºæ•£æ¼”ç®—ï¼Œ$`\nabla^{n+1} \cdot {\bf b}^n = \sum _j \dfrac{m _j}{\rho _j^{n+1}}({\bf b} _j^n-{\bf b} _i^n)\cdot \nabla W({\bf x} _i^{n+1},{\bf x} _j^{n+1},h)`$ 

$`\nabla^{n+1}`$ã®è¨ˆç®—ã«ã¯ï¼Œ$`\rho^{n+1}`$, $`{\bf x}^{n+1}= {\bf x}^{n} + {\bf u}^{n+1} \Delta t`$ãŒå¿…è¦ã§ã‚ã‚‹ï¼

* [æ¬¡æ™‚åˆ»ã®ç²’å­ä½“ç©](../../builds/build_sph/SPH_Functions.hpp#L183)
* [æ¬¡æ™‚åˆ»ã®ç²’å­å¯†åº¦](../../builds/build_sph/SPH_Functions.hpp#L165)
* [æ¬¡æ™‚åˆ»ã®ç²’å­ä½ç½®](../../builds/build_sph/SPH_Functions.hpp#L186)


[./SPH2_FindPressure.hpp#L89](./SPH2_FindPressure.hpp#L89)


---
å„ç²’å­`ROW`ãŒï¼Œæµä½“ã‹å£ã‹è£œåŠ©ç²’å­ã‹æ°´é¢ã‹ã«ã‚ˆã£ã¦ï¼Œæ–¹ç¨‹å¼ãŒç•°ãªã‚‹ï¼

|æ–¹ç¨‹å¼|ç›®çš„|
|:---------|---|
| â˜‘ï¸ [ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼](../../builds/build_sph/SPH2_FindPressure.hpp#L204)              | æ¬¡æ™‚åˆ»ã®æµé€Ÿã®ç™ºæ•£ã‚’ã‚¼ãƒ­ã«ã™ã‚‹ï¼ˆéåœ§ç¸®æ€§ã‚’æº€ãŸã™ï¼‰ã‚ˆã†ã«åœ§åŠ›ã‚’æ±ºå®šã™ã‚‹ï¼ |
| â˜ [ä¸é€éæ¡ä»¶](../../builds/build_sph/SPH2_FindPressure.hpp#L151)         | ã“ã®å¼ã¯åœ§åŠ›å‹¾é…ãŒãã‚Œä»¥å¤–ã®åŠ›ã‚’æ‰“ã¡æ¶ˆã™ã‚ˆã†ã«åœ§åŠ›ã‚’æ±ºå®šã™ã‚‹ï¼å£é¢ä»˜è¿‘ã®åœ§åŠ›ãŒæ»‘ã‚‰ã‹ã«ãªã‚‰ãªã„ãŸã‚ä½¿ã‚ãªã„ï¼ |
| â˜ [å¤§æ°—åœ§æ¡ä»¶](../../builds/build_sph/SPH2_FindPressure.hpp#L184) | ã“ã®å¼ã¯æ°´é¢ç²’å­ã®åœ§åŠ›ã‚’ã‚¼ãƒ­ã«å›ºå®šã™ã‚‹ï¼åœ§åŠ›ãŒã‚¼ãƒ­ã§ã‚ã‚‹ã¹ãå ´æ‰€ã¯æ°´é¢ã‹ã‚‰$h/2$ä¸Šãªã®ã§ä½¿ã‚ãªã„ï¼ |

å„æ–¹ç¨‹å¼ã¯ï¼Œ`equation(åˆ—ç•ªå·ã‚’æŒ‡å®šã™ã‚‹ç²’å­ãƒã‚¤ãƒ³ã‚¿, è¨ˆç®—ã«ä½¿ã‚ã‚Œã‚‹ç‰©æ€§å€¤ã‚’æŒã¤ç²’å­ãƒã‚¤ãƒ³ã‚¿, æ–¹ç¨‹å¼ã‚’ç«‹ã¦ã‚‹ä½ç½®)`ã®å½¢ã§ä½¿ç”¨ã™ã‚‹ï¼


[./SPH2_FindPressure.hpp#L137](./SPH2_FindPressure.hpp#L137)


---
## â›µ ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼ã®è§£æ³• 

ISPHã®ãƒã‚¢ã‚½ãƒ³æ–¹ç¨‹å¼ã‚’è§£ãå ´åˆï¼Œ[ã“ã“ã§ã¯GMRESæ³•](../../builds/build_sph/SPH2_FindPressure.hpp#L502)ã‚’ä½¿ã†ï¼


[./SPH2_FindPressure.hpp#L405](./SPH2_FindPressure.hpp#L405)


---
## â›µ åœ§åŠ›å‹¾é…$`\nabla p^{n+1}`$ã®è¨ˆç®— 

âœ… [å‹¾é…ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH3_grad_P.hpp#L116): $`\nabla p _i = \rho _i \sum _{j} m _j (\frac{p _i}{\rho _i^2} + \frac{p _j}{\rho _j^2}) \nabla W _{ij}`$

âœ… [å‹¾é…ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH3_grad_P.hpp#L64): $`\nabla p _i = \rho _i \sum _{j} m _j \left(p _j - p _i\right) \nabla W _{ij}`$

âœ… [å‹¾é…ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH3_grad_P.hpp#L75): $`\nabla p _i = \sum _{j} \frac{m _j}{\rho _j} p _j \nabla W _{ij}`$


[./SPH3_grad_P.hpp#L11](./SPH3_grad_P.hpp#L11)


$`\dfrac{D{\bf u}^n}{Dt} = - \frac{1}{\rho} \nabla p^{n+1} + \nu \nabla^2 {\bf u}^n + {\bf g}`$
ãŒè¨ˆç®—ã§ããŸï¼


[./SPH3_grad_P.hpp#L121](./SPH3_grad_P.hpp#L121)


---
## â›µ æ³¨æ„ç‚¹ 

âš ï¸ è¨ˆç®—ãŒã†ã¾ãè¡Œãè¨­å®šã‚’çŸ¥ã‚‹ãŸã‚ã«ï¼Œæ¬¡ã®ç®‡æ‰€ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ï¼

**NEW**

- [å£ç²’å­ã®é€Ÿåº¦ã®æ±ºå®šæ–¹æ³•](../../builds/build_sph/SPH0_setWall_Freesurface.hpp#L357)
- [Poissonã«ãŠã„ã¦ã©ã®ã‚ˆã†ã«bãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½¿ã†ã‹](../../builds/build_sph/SPH2_FindPressure.hpp#L127)
- [Poissonã«ãŠã„ã¦ã©ã®ã‚ˆã†ã«bãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½¿ã†ã‹](../../builds/build_sph/SPH2_FindPressure.hpp#L198)
- ã©ã®ã‚ˆã†ã«[å£ç²’å­ã®b](not found)/[æµä½“ç²’å­ã®b](../../builds/build_sph/SPH1_lap_div_U.hpp#L91)ã‚’ä½œã‚‹ã‹

**å£ç²’å­**

- [å£ç²’å­ã®ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH1_lap_div_U.hpp#L68)
- [åœ§åŠ›ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH2_FindPressure.hpp#L106)
- [ã©ã®ä½ç½®ã«ãŠã„ã¦æ–¹ç¨‹å¼ã‚’ç«‹ã¦ã‚‹ã‹](../../builds/build_sph/SPH2_FindPressure.hpp#L278)
- [æµä½“ã¨ã—ã¦æ‰±ã†å£ç²’å­ã‚’è¨­å®šã™ã‚‹ã‹ã©ã†ã‹](../../builds/build_sph/SPH0_setWall_Freesurface.hpp#L265)/[è¦–é‡è§’ã«æµä½“ç²’å­ãŒå«ã¾ãªã„å£ç²’å­ã¯é™¤å¤–ã™ã‚‹](not found)
- [å£ç²’å­ã®åœ§åŠ›ã‚’ã©ã®ã‚ˆã†ã«å£é¢ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‹](not found)
- [å£ç²’å­ã®æ³•ç·šæ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH0_setWall_Freesurface.hpp#L494)
- [åå°„ã®è¨ˆç®—æ–¹æ³•](../../builds/build_sph/SPH_Functions.hpp#L273)

**æ°´é¢ç²’å­**

- [æ°´é¢ç²’å­ã®åœ§åŠ›ã‚’ã‚¼ãƒ­ã«ã™ã‚‹ã‹ã©ã†ã‹](not found)
- [è£œåŠ©ç²’å­ã®è¨­å®šã¯ã©ã†ãªã£ã¦ã„ã‚‹ã‹](../../include/Network.hpp#L492)

**ãã®ä»–**

- [å¯†åº¦ã‚’æ›´æ–°ã™ã‚‹ã‹ã©ã†ã‹](../../builds/build_sph/SPH_Functions.hpp#L325)
- [åœ§åŠ›ã®å®‰å®šåŒ–ã‚’ã™ã‚‹ã‹ã©ã†ã‹](not found)
- [ãƒ«ãƒ³ã‚²ã‚¯ãƒƒã‚¿ã®æ®µæ•°](../../builds/build_sph/from os.py#L145)


å£ã®wall_as_fluidã¯ç¹°ã‚Šè¿”ã—ã§è¨ˆç®—ã™ã‚‹ã®ã¯ã©ã†ã‹ï¼Ÿ


[./SPH_Functions.hpp#L351](./SPH_Functions.hpp#L351)


---
# ğŸ‹ å®Ÿè¡Œæ–¹æ³• 

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ï¼Œ`build_sph`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ï¼
âš ï¸ä¸Šæ›¸ãã•ã‚Œã‚‹ã®ã§æ³¨æ„ï¼

```sh
git clone https://github.com/tomoakihirakawa/cpp.git
cd ./cpp/builds/build_sph
```

`clean`ã§CMakeé–¢é€£ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¦ï¼ˆã‚´ãƒŸãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ï¼‰ï¼Œ
`cmake`ã§`Makefile`ã‚’ç”Ÿæˆã—ã¦ï¼Œ`make`ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ï¼

```sh
sh clean
cmake -DCMAKE_BUILD_TYPE=Release ../
make
```

æ¬¡ã«ï¼Œå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆï¼

```sh
python3 input_generator.py
```

ä¾‹ãˆã°ï¼Œ`./input_files/static_pressure_PS0d0125_CSML2d4_RK1`ãŒç”Ÿæˆã•ã‚Œã‚‹ï¼
å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œï¼

```sh
./main ./input_files/static_pressure_PS0d0125_CSML2d4_RK1
```


[./main.cpp#L1](./main.cpp#L1)


---
# ğŸ‹ Bucketã‚’ç”¨ã„ãŸç²’å­æ¢ç´¢ã®ãƒ†ã‚¹ãƒˆ 

Smoothed Particle Hydrodynamics (SPH)ã§ã¯ï¼ŒåŠ¹ç‡çš„ãªè¿‘å‚ç²’å­æ¢æŸ»ãŒå¿…è¦ã¨ãªã‚‹ï¼
ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ï¼ŒBucketã‚’ç”¨ã„ãŸç²’å­æ¢ç´¢ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ï¼

çµæœã¯VTKãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã•ã‚Œã‚‹ï¼
* å…¨ã¦ã®ç²’å­ã‚’è¡¨ç¤ºã—ãŸã‚‚ã®ã¯`all.vtp`
* ä¸­å¿ƒã®ç²’å­ã‚’è¡¨ç¤ºã—ãŸã‚‚ã®ã¯`center*.vtp`
* ä¸­å¿ƒã®ç²’å­ãŒæ¢æŸ»ã—ãŸã‚»ãƒ«å†…ã«ã‚ã‚‹ç²’å­ã‚’è¡¨ç¤ºã—ãŸã‚‚ã®ã¯`inCell*.vtp`
* ã‚»ãƒ«å†…ã‹ã¤çƒå†…ã«ã‚ã‚‹ç²’å­ã‚’è¡¨ç¤ºã—ãŸã‚‚ã®ã¯`inSphere*.vtp`

- å„ã‚»ãƒ«ã«ã‚ã‚‹ç²’å­ã‚’è¡¨ç¤ºã—ãŸã‚‚ã®ã¯`each_cell*.vtp`
- å„ã‚»ãƒ«ã®ä¸­å¿ƒä½ç½®ã‚’è¡¨ç¤ºã—ãŸã‚‚ã®ã¯`each_cell_position*.vtp`


[./test_Buckets.cpp#L2](./test_Buckets.cpp#L2)


---



[./main.cpp#L368](./main.cpp#L368)


---
# ğŸ‹ ãƒ†ã‚¹ãƒˆ 

## â›µ æ ¸é–¢æ•°ã®ãƒ†ã‚¹ãƒˆ 

<!-- Key SPH:kernelFunctions not found -->

ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã—ãŸ[3æ¬¡ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³é–¢æ•°](../../include/kernelFunctions.hpp#L174)ã¨[5æ¬¡ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³é–¢æ•°](../../include/kernelFunctions.hpp#L73)ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

* é–¢æ•°ã®å½¢çŠ¶ã‚’ç¢ºèªï¼
* ä½“ç©ç©åˆ†ãŒ1ã«ãªã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªï¼

| åˆ†å‰²æ•°$N$ï¼Œä½“ç©$`V=(\frac{2r}{N})^3`$   | Sum for 3rd Order | Sum for 5th Order |
| --- | ----------------- | ----------------- |
| 5   | 1.00527           | 0.999206          |
| 10  | 1.00011           | 1.00005           |
| 15  | 0.999972          | 0.999999          |
| 20  | 1                 | 1                 |
| 25  | 1                 | 1                 |


[./test_KernelFunctions.cpp#L1](./test_KernelFunctions.cpp#L1)


---
