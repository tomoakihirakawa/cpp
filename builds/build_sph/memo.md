非圧縮性および粘性流体のための無発散SPH（Divergence-Free SPH）手法

概要

本研究では、低い体積圧縮率と無発散の速度場を同時に維持する2つの新しい陰的圧力ソルバを組み合わせる手法を提案しました ￼。流体を圧縮しないようにすること（密度が一定であること）は現実的な物理挙動を再現する上で不可欠であり、また速度場が無発散（ダイバージェンスゼロ）であることにより必要なソルバ反復回数が大幅に削減され、シミュレーションの安定性が飛躍的に向上します ￼。安定性の向上により本手法では従来よりも大きなタイムステップで計算を進めることが可能となり、その結果、計算コストの高い近傍粒子検索の頻度を減らすことで性能が大幅に向上します ￼。さらに、本手法には高粘度流体用の陰的粘性ソルバをオプションとして統合しており、これによって数値的減衰をほとんど発生させることなくリアルな結果を得ることができます ￼。本手法の有効性・堅牢性・スケーラビリティは、数百万の粒子による乱流や高粘度の物質を含む複雑なシミュレーションによって実証されました ￼。

はじめに

計算機グラフィックスの分野では、Smoothed Particle Hydrodynamics (SPH; スムーズ粒子流体力学) が複雑な流体効果をシミュレーションするための重要な、メッシュを用いないラグランジュ的手法として広く用いられています ￼。SPHでは、流体中のある粒子に関する物理量をその近傍に存在する有限個の粒子のみを考慮して効率的に計算することが可能です ￼。SPH手法における最大の課題の一つは、流体の非圧縮性（圧力による体積変化がない性質）を忠実に再現することです。自然界で我々が目にするほとんどの流体は実質的に非圧縮性であるため、幅広い材料の流体を現実的にアニメーション表現するには非圧縮性を正確に維持することが重要です ￼。密接に関連する課題として、高い粘度を持つ流体（例：ハチミツや泥）のシミュレーションも挙げられ、これらも同様に重要な流体現象です ￼。本論文では、非圧縮性流体のシミュレーションに適した効率的な無発散SPH（ダイバージェンスフリーSPH、DFSPH）手法を提案します ￼。さらに、本手法を陰的粘性ソルバによって拡張し、高粘度流体のシミュレーションを可能にしています ￼。

非圧縮性の流体をモデル化するために、本研究ではラグランジュ座標系で記述される非圧縮性かつ等温のナビエ–ストークス方程式をシミュレーションの基礎としています ￼:

$$
\frac{D \rho}{D t} = 0 \iff \nabla \cdot \mathbf{v} = 0,
\tag{1}
$$

$$
\frac{D \mathbf{v}}{D t} = -\frac{1}{\rho},\nabla p + \nu \nabla^2 \mathbf{v} + \frac{\mathbf{f}}{\rho},,
\tag{2}
$$

ここで $D(\cdot)/Dt$ は物質微分を表し、$\rho,; p,; \nu,; \mathbf{v},; \mathbf{f}$ はそれぞれ密度、圧力、動粘性率、速度、および外力密度場を意味します ￼。式 (1) は、非圧縮性流体では速度場が発散のない（無発散な）状態($\nabla \cdot \mathbf{v} = 0$)にあることを示しています ￼。密度が時間とともに変化しないこと ($D\rho/Dt = 0$) および連続の方程式 $D\rho/Dt = -,\rho,\nabla \cdot \mathbf{v}$ を用いれば、式 (1) の右辺と左辺が等価であることが分かります ￼。したがって理論的には、無発散の速度場を持つ流体は密度を一定に保つため非圧縮性であると言えます ￼。しかし実際には、SPHのシミュレーションで無発散条件のみを課しても完全に非圧縮性を保証することはできません ￼。数値積分の過程で誤差が蓄積し、その結果、密度にわずかな偏差が生じます。この偏差は無発散条件では補正されないため、体積のわずかな圧縮を避けることができないのです ￼。非圧縮性を厳密に満たすには、次の式による第二の条件を課す必要があります ￼:

$$
\rho - \rho_0 = 0,,
\tag{3}
$$

この条件は密度一定条件と呼ばれます ￼。要するに、非圧縮性・等温のナビエ–ストークス方程式では無発散の速度場（式(1)）が要求され ￼、さらに数値誤差による密度偏差を打ち消すため密度一定条件を適用して安定性を保つ必要があります ￼。

近年、圧力によって体積圧縮を抑制するいくつかの陰的SPH圧力ソルバが研究されています ￼。現在、最も効率的な圧力ソルバは密度一定条件のみを考慮しており、この条件は粒子の位置にのみ依存するため、非圧縮性流れの連続の式が要求する無発散条件は一般には満たされていません ￼（図2の左に例示）。 ￼また、速度場のダイバージェンス（発散）を補正するSPH手法はごく少数しか提案されていませんが、それらの手法は計算速度が遅いか、密度誤差を十分小さく保てないという問題があります ￼。

ここ数年で、効率的な密度一定ソルバが多数提案されており、例えば予測・修正型非圧縮SPH（Predictive-Corrective Incompressible SPH, PCISPH） ￼や陰的非圧縮SPH（Implicit Incompressible SPH, IISPH） ￼が挙げられます。しかし本論文では、無発散ソルバと類似したアプローチで動作し、事前に計算した係数を再利用できる新たな手法を提案します ￼。この手法では圧力ソルバ同士を組み合わせて用いることで、最新のSPH手法よりも明確に高い性能を発揮し、典型的なシミュレーションシナリオにおいて従来の方法より20倍以上高速であることが示されました ￼。