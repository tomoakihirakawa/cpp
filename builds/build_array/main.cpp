#include <algorithm>
#include <array>
#include <iostream>
#include <string>
#include <type_traits>
// #include "basic.hpp"
#include "basic_IO.hpp"
#include "basic_arithmetic_array_operations.hpp"
#include "lib_measurement.hpp"

// /Users/tomoaki/Library/CloudStorage/Dropbox/code/cpp/builds/build_array/array演算が正しく行われているか.nb

int main() {
   auto w = std::setw(30);
   auto rand = 0.212602;
   auto irand = 5;
   std::array<std::array<double, 3>, 3> a{{{0.970021, 0.471696, 0.073693}, {0.236597, 0.907031, 0.638261}, {0.986103, 0.326046, 0.353901}}};
   std::array<std::array<double, 3>, 3> b{{{0.392562, 0.79054, 0.585415}, {0.573497, 0.88363, 0.292607}, {0.441798, 0.483906, 0.0234303}}};
   std::array<double, 3> row = {0.0298314, 0.597412, 0.915869};
   std::array<double, 3> U = {0.585809, 0.30492, 0.294832};
   std::array<double, 3> V = {0.132501, 0.0212211, 0.55173};
   std::array<double, 3> W = {0.501788, 0.748433, 0.522016};
   std::array<double, 4> X = {0.966535, 0.686424, 0.719155, 0.414197};
   std::array<double, 4> Y = {0.67928, 0.920476, 0.541537, 0.216552};
   std::array<double, 4> Z = {0.785039, 0.454981, 0.532361, 0.812351};
   std::cout << w << "rand = " << (rand) << std::endl;
   std::cout << w << 0.212602 << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand)-0.212602) << colorOff << std::endl;
   std::cout << w << "irand = " << (irand) << std::endl;
   std::cout << w << 5 << std::endl;
   std::cout << w << Red << "Error = " << Norm((irand)-5) << colorOff << std::endl;
   std::cout << w << "a = " << (a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.970021, 0.471696, 0.073693}, {0.236597, 0.907031, 0.638261}, {0.986103, 0.326046, 0.353901}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a)-std::array<std::array<double, 3>, 3>{{{0.970021, 0.471696, 0.073693}, {0.236597, 0.907031, 0.638261}, {0.986103, 0.326046, 0.353901}}}) << colorOff << std::endl;
   std::cout << w << "b = " << (b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.392562, 0.79054, 0.585415}, {0.573497, 0.88363, 0.292607}, {0.441798, 0.483906, 0.0234303}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((b)-std::array<std::array<double, 3>, 3>{{{0.392562, 0.79054, 0.585415}, {0.573497, 0.88363, 0.292607}, {0.441798, 0.483906, 0.0234303}}}) << colorOff << std::endl;
   std::cout << w << "a/irand = " << (a / irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.194004, 0.0943392, 0.0147386}, {0.0473195, 0.181406, 0.127652}, {0.197221, 0.0652091, 0.0707803}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a / irand) - std::array<std::array<double, 3>, 3>{{{0.194004, 0.0943392, 0.0147386}, {0.0473195, 0.181406, 0.127652}, {0.197221, 0.0652091, 0.0707803}}}) << colorOff << std::endl;
   std::cout << w << "row = " << (row) << std::endl;
   std::cout << w << std::array<double, 3>{{0.0298314, 0.597412, 0.915869}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row)-std::array<double, 3>{{0.0298314, 0.597412, 0.915869}}) << colorOff << std::endl;
   std::cout << w << "row/irand = " << (row / irand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.00596628, 0.119482, 0.183174}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row / irand) - std::array<double, 3>{{0.00596628, 0.119482, 0.183174}}) << colorOff << std::endl;
   std::cout << "negate" << std::endl;
   std::cout << w << "-a = " << (-a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.970021, -0.471696, -0.073693}, {-0.236597, -0.907031, -0.638261}, {-0.986103, -0.326046, -0.353901}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((-a) - std::array<std::array<double, 3>, 3>{{{-0.970021, -0.471696, -0.073693}, {-0.236597, -0.907031, -0.638261}, {-0.986103, -0.326046, -0.353901}}}) << colorOff << std::endl;
   std::cout << w << "-b = " << (-b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.392562, -0.79054, -0.585415}, {-0.573497, -0.88363, -0.292607}, {-0.441798, -0.483906, -0.0234303}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((-b) - std::array<std::array<double, 3>, 3>{{{-0.392562, -0.79054, -0.585415}, {-0.573497, -0.88363, -0.292607}, {-0.441798, -0.483906, -0.0234303}}}) << colorOff << std::endl;
   std::cout << "+" << std::endl;
   std::cout << w << "a+b = " << (a + b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.36258, 1.26224, 0.659108}, {0.810095, 1.79066, 0.930869}, {1.4279, 0.809952, 0.377332}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + b) - std::array<std::array<double, 3>, 3>{{{1.36258, 1.26224, 0.659108}, {0.810095, 1.79066, 0.930869}, {1.4279, 0.809952, 0.377332}}}) << colorOff << std::endl;
   std::cout << w << "a-b = " << (a - b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.577459, -0.318844, -0.511722}, {-0.3369, 0.0234007, 0.345654}, {0.544306, -0.15786, 0.330471}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a - b) - std::array<std::array<double, 3>, 3>{{{0.577459, -0.318844, -0.511722}, {-0.3369, 0.0234007, 0.345654}, {0.544306, -0.15786, 0.330471}}}) << colorOff << std::endl;
   std::cout << w << "a+row = " << (a + row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.999853, 0.501527, 0.103524}, {0.834009, 1.50444, 1.23567}, {1.90197, 1.24192, 1.26977}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + row) - std::array<std::array<double, 3>, 3>{{{0.999853, 0.501527, 0.103524}, {0.834009, 1.50444, 1.23567}, {1.90197, 1.24192, 1.26977}}}) << colorOff << std::endl;
   std::cout << w << "row+a = " << (row + a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.999853, 0.501527, 0.103524}, {0.834009, 1.50444, 1.23567}, {1.90197, 1.24192, 1.26977}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row + a) - std::array<std::array<double, 3>, 3>{{{0.999853, 0.501527, 0.103524}, {0.834009, 1.50444, 1.23567}, {1.90197, 1.24192, 1.26977}}}) << colorOff << std::endl;
   std::cout << w << "a+irand = " << (a + irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{5.97002, 5.4717, 5.07369}, {5.2366, 5.90703, 5.63826}, {5.9861, 5.32605, 5.3539}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + irand) - std::array<std::array<double, 3>, 3>{{{5.97002, 5.4717, 5.07369}, {5.2366, 5.90703, 5.63826}, {5.9861, 5.32605, 5.3539}}}) << colorOff << std::endl;
   std::cout << w << "row+irand = " << (row + irand) << std::endl;
   std::cout << w << std::array<double, 3>{{5.02983, 5.59741, 5.91587}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row + irand) - std::array<double, 3>{{5.02983, 5.59741, 5.91587}}) << colorOff << std::endl;
   std::cout << "-" << std::endl;
   std::cout << w << "a-row = " << (a - row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.94019, 0.441865, 0.0438616}, {-0.360815, 0.309619, 0.0408493}, {0.0702339, -0.589824, -0.561968}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a - row) - std::array<std::array<double, 3>, 3>{{{0.94019, 0.441865, 0.0438616}, {-0.360815, 0.309619, 0.0408493}, {0.0702339, -0.589824, -0.561968}}}) << colorOff << std::endl;
   std::cout << w << "row-a = " << (row - a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.94019, -0.441865, -0.0438616}, {0.360815, -0.309619, -0.0408493}, {-0.0702339, 0.589824, 0.561968}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row - a) - std::array<std::array<double, 3>, 3>{{{-0.94019, -0.441865, -0.0438616}, {0.360815, -0.309619, -0.0408493}, {-0.0702339, 0.589824, 0.561968}}}) << colorOff << std::endl;
   std::cout << w << "a+rand = " << (a + rand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.18262, 0.684298, 0.286295}, {0.449199, 1.11963, 0.850863}, {1.19871, 0.538648, 0.566503}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + rand) - std::array<std::array<double, 3>, 3>{{{1.18262, 0.684298, 0.286295}, {0.449199, 1.11963, 0.850863}, {1.19871, 0.538648, 0.566503}}}) << colorOff << std::endl;
   std::cout << w << "rand+a = " << (rand + a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.18262, 0.684298, 0.286295}, {0.449199, 1.11963, 0.850863}, {1.19871, 0.538648, 0.566503}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand + a) - std::array<std::array<double, 3>, 3>{{{1.18262, 0.684298, 0.286295}, {0.449199, 1.11963, 0.850863}, {1.19871, 0.538648, 0.566503}}}) << colorOff << std::endl;
   std::cout << w << "a+irand = " << (a + irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{5.97002, 5.4717, 5.07369}, {5.2366, 5.90703, 5.63826}, {5.9861, 5.32605, 5.3539}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + irand) - std::array<std::array<double, 3>, 3>{{{5.97002, 5.4717, 5.07369}, {5.2366, 5.90703, 5.63826}, {5.9861, 5.32605, 5.3539}}}) << colorOff << std::endl;
   std::cout << w << "row+irand = " << (row + irand) << std::endl;
   std::cout << w << std::array<double, 3>{{5.02983, 5.59741, 5.91587}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row + irand) - std::array<double, 3>{{5.02983, 5.59741, 5.91587}}) << colorOff << std::endl;
   std::cout << "*" << std::endl;
   std::cout << w << "row*rand = " << (row * rand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.00634222, 0.127011, 0.194716}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row * rand) - std::array<double, 3>{{0.00634222, 0.127011, 0.194716}}) << colorOff << std::endl;
   std::cout << w << "rand*row = " << (rand * row) << std::endl;
   std::cout << w << std::array<double, 3>{{0.00634222, 0.127011, 0.194716}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand * row) - std::array<double, 3>{{0.00634222, 0.127011, 0.194716}}) << colorOff << std::endl;
   std::cout << w << "a*rand = " << (a * rand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.206228, 0.100284, 0.0156673}, {0.0503011, 0.192837, 0.135696}, {0.209648, 0.069318, 0.0752401}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a * rand) - std::array<std::array<double, 3>, 3>{{{0.206228, 0.100284, 0.0156673}, {0.0503011, 0.192837, 0.135696}, {0.209648, 0.069318, 0.0752401}}}) << colorOff << std::endl;
   std::cout << w << "rand*a = " << (rand * a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.206228, 0.100284, 0.0156673}, {0.0503011, 0.192837, 0.135696}, {0.209648, 0.069318, 0.0752401}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand * a) - std::array<std::array<double, 3>, 3>{{{0.206228, 0.100284, 0.0156673}, {0.0503011, 0.192837, 0.135696}, {0.209648, 0.069318, 0.0752401}}}) << colorOff << std::endl;
   std::cout << w << "a*irand = " << (a * irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{4.85011, 2.35848, 0.368465}, {1.18299, 4.53515, 3.19131}, {4.93052, 1.63023, 1.76951}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a * irand) - std::array<std::array<double, 3>, 3>{{{4.85011, 2.35848, 0.368465}, {1.18299, 4.53515, 3.19131}, {4.93052, 1.63023, 1.76951}}}) << colorOff << std::endl;
   std::cout << w << "row*irand = " << (row * irand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.149157, 2.98706, 4.57935}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row * irand) - std::array<double, 3>{{0.149157, 2.98706, 4.57935}}) << colorOff << std::endl;
   std::cout << "/" << std::endl;
   std::cout << w << "row/rand = " << (row / rand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.140316, 2.81, 4.30791}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row / rand) - std::array<double, 3>{{0.140316, 2.81, 4.30791}}) << colorOff << std::endl;
   std::cout << w << "rand/row = " << (rand / row) << std::endl;
   std::cout << w << std::array<double, 3>{{7.12678, 0.355872, 0.232131}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand / row) - std::array<double, 3>{{7.12678, 0.355872, 0.232131}}) << colorOff << std::endl;
   std::cout << w << "a/rand = " << (a / rand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{4.56262, 2.21868, 0.346624}, {1.11286, 4.26633, 3.00214}, {4.63826, 1.5336, 1.66462}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a / rand) - std::array<std::array<double, 3>, 3>{{{4.56262, 2.21868, 0.346624}, {1.11286, 4.26633, 3.00214}, {4.63826, 1.5336, 1.66462}}}) << colorOff << std::endl;
   std::cout << w << "rand/a = " << (rand / a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.219173, 0.450718, 2.88497}, {0.898582, 0.234393, 0.333095}, {0.215598, 0.652062, 0.600738}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand / a) - std::array<std::array<double, 3>, 3>{{{0.219173, 0.450718, 2.88497}, {0.898582, 0.234393, 0.333095}, {0.215598, 0.652062, 0.600738}}}) << colorOff << std::endl;
   std::cout << w << "a/irand = " << (a / irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.194004, 0.0943392, 0.0147386}, {0.0473195, 0.181406, 0.127652}, {0.197221, 0.0652091, 0.0707803}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a / irand) - std::array<std::array<double, 3>, 3>{{{0.194004, 0.0943392, 0.0147386}, {0.0473195, 0.181406, 0.127652}, {0.197221, 0.0652091, 0.0707803}}}) << colorOff << std::endl;
   std::cout << w << "row/irand = " << (row / irand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.00596628, 0.119482, 0.183174}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row / irand) - std::array<double, 3>{{0.00596628, 0.119482, 0.183174}}) << colorOff << std::endl;
   std::cout << "+=, -=, *=, /=" << std::endl;
   std::cout << w << "a+=b = " << (a += b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.36258, 1.26224, 0.659108}, {0.810095, 1.79066, 0.930869}, {1.4279, 0.809952, 0.377332}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a += b) - std::array<std::array<double, 3>, 3>{{{1.36258, 1.26224, 0.659108}, {0.810095, 1.79066, 0.930869}, {1.4279, 0.809952, 0.377332}}}) << colorOff << std::endl;
   std::cout << w << "a-=b = " << (a -= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.970021, 0.471696, 0.073693}, {0.236597, 0.907031, 0.638261}, {0.986103, 0.326046, 0.353901}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a -= b) - std::array<std::array<double, 3>, 3>{{{0.970021, 0.471696, 0.073693}, {0.236597, 0.907031, 0.638261}, {0.986103, 0.326046, 0.353901}}}) << colorOff << std::endl;
   std::cout << w << "a*=b = " << (a *= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.380794, 0.372895, 0.043141}, {0.135688, 0.80148, 0.18676}, {0.435658, 0.157775, 0.00829203}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a *= b) - std::array<std::array<double, 3>, 3>{{{0.380794, 0.372895, 0.043141}, {0.135688, 0.80148, 0.18676}, {0.435658, 0.157775, 0.00829203}}}) << colorOff << std::endl;
   std::cout << w << "a*=row = " << (a *= row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0113596, 0.011124, 0.00128696}, {0.0810616, 0.478814, 0.111573}, {0.399006, 0.144502, 0.00759441}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a *= row) - std::array<std::array<double, 3>, 3>{{{0.0113596, 0.011124, 0.00128696}, {0.0810616, 0.478814, 0.111573}, {0.399006, 0.144502, 0.00759441}}}) << colorOff << std::endl;
   std::cout << w << "a/=b = " << (a /= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0289371, 0.0140714, 0.00219837}, {0.141346, 0.541871, 0.381305}, {0.903142, 0.298615, 0.324127}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= b) - std::array<std::array<double, 3>, 3>{{{0.0289371, 0.0140714, 0.00219837}, {0.141346, 0.541871, 0.381305}, {0.903142, 0.298615, 0.324127}}}) << colorOff << std::endl;
   std::cout << w << "a/=row = " << (a /= row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.970021, 0.471696, 0.073693}, {0.236597, 0.907031, 0.638261}, {0.986103, 0.326046, 0.353901}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= row) - std::array<std::array<double, 3>, 3>{{{0.970021, 0.471696, 0.073693}, {0.236597, 0.907031, 0.638261}, {0.986103, 0.326046, 0.353901}}}) << colorOff << std::endl;
   std::cout << w << "a/=b = " << (a /= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{2.471, 0.596676, 0.125882}, {0.412552, 1.02648, 2.18129}, {2.23202, 0.673779, 15.1044}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= b) - std::array<std::array<double, 3>, 3>{{{2.471, 0.596676, 0.125882}, {0.412552, 1.02648, 2.18129}, {2.23202, 0.673779, 15.1044}}}) << colorOff << std::endl;
   std::cout << w << "a/=row = " << (a /= row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{82.8322, 20.0016, 4.21977}, {0.690564, 1.71821, 3.65123}, {2.43706, 0.735672, 16.4919}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= row) - std::array<std::array<double, 3>, 3>{{{82.8322, 20.0016, 4.21977}, {0.690564, 1.71821, 3.65123}, {2.43706, 0.735672, 16.4919}}}) << colorOff << std::endl;
   std::cout << "Tensor Operation" << std::endl;
   std::cout << w << "TensorProduct(U,X) = " << (TensorProduct(U, X)) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{0.566205, 0.402113, 0.421288, 0.24264}, {0.294716, 0.209304, 0.219285, 0.126297}, {0.284966, 0.20238, 0.21203, 0.122119}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((TensorProduct(U, X)) - std::array<std::array<double, 4>, 3>{{{0.566205, 0.402113, 0.421288, 0.24264}, {0.294716, 0.209304, 0.219285, 0.126297}, {0.284966, 0.20238, 0.21203, 0.122119}}}) << colorOff << std::endl;
   std::cout << w << "Dot(W,TensorProduct(TensorProduct(U,X),V)) = " << (Dot(W, TensorProduct(TensorProduct(U, X), V))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.0865822, 0.0138668, 0.360526}, {0.0614898, 0.0098481, 0.256042}, {0.0644219, 0.0103177, 0.268251}, {0.0371037, 0.00594247, 0.154499}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, TensorProduct(TensorProduct(U, X), V))) - std::array<std::array<double, 3>, 4>{{{0.0865822, 0.0138668, 0.360526}, {0.0614898, 0.0098481, 0.256042}, {0.0644219, 0.0103177, 0.268251}, {0.0371037, 0.00594247, 0.154499}}}) << colorOff << std::endl;
   std::cout << w << "Dot(Z,Dot(W,TensorProduct(TensorProduct(TensorProduct(U,X),V),Y))) = " << (Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(U, X), V), Y)))) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{0.108946, 0.14763, 0.086854, 0.0347315}, {0.0174485, 0.0236441, 0.0139104, 0.00556254}, {0.453646, 0.614726, 0.361657, 0.144621}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(U, X), V), Y)))) - std::array<std::array<double, 4>, 3>{{{0.108946, 0.14763, 0.086854, 0.0347315}, {0.0174485, 0.0236441, 0.0139104, 0.00556254}, {0.453646, 0.614726, 0.361657, 0.144621}}}) << colorOff << std::endl;
   std::cout << w << "Dot(Y,Dot(U,Dot(Z,Dot(W,TensorProduct(TensorProduct(TensorProduct(TensorProduct(U,X),V),Y),Z))))) = " << (Dot(Y, Dot(U, Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z)))))) << std::endl;
   std::cout << w << std::array<double, 4>{{0.386624, 0.224074, 0.262182, 0.400075}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(Y, Dot(U, Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z)))))) - std::array<double, 4>{{0.386624, 0.224074, 0.262182, 0.400075}}) << colorOff << std::endl;
   std::cout << w << "Dot(W,10*TensorProduct(TensorProduct(U,X),V)) = " << (Dot(W, 10 * TensorProduct(TensorProduct(U, X), V))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.865822, 0.138668, 3.60526}, {0.614898, 0.098481, 2.56042}, {0.644219, 0.103177, 2.68251}, {0.371037, 0.0594247, 1.54499}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, 10 * TensorProduct(TensorProduct(U, X), V))) - std::array<std::array<double, 3>, 4>{{{0.865822, 0.138668, 3.60526}, {0.614898, 0.098481, 2.56042}, {0.644219, 0.103177, 2.68251}, {0.371037, 0.0594247, 1.54499}}}) << colorOff << std::endl;
   std::cout << w << "Dot(W,Dot(TensorProduct(TensorProduct(TensorProduct(U,X),V),Y),Z)) = " << (Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.122624, 0.0196392, 0.510602}, {0.0870862, 0.0139476, 0.362624}, {0.0912388, 0.0146126, 0.379916}, {0.0525489, 0.00841614, 0.218812}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) - std::array<std::array<double, 3>, 4>{{{0.122624, 0.0196392, 0.510602}, {0.0870862, 0.0139476, 0.362624}, {0.0912388, 0.0146126, 0.379916}, {0.0525489, 0.00841614, 0.218812}}}) << colorOff << std::endl;
   std::cout << w << "Dot(W,Dot(TensorProduct(TensorProduct(TensorProduct(U,Y),W),Z)+TensorProduct(TensorProduct(TensorProduct(U,X),V),Y),Z)) = " << (Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, Y), W), Z) + TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.529726, 0.626845, 0.934115}, {0.638741, 0.836759, 0.936517}, {0.41579, 0.498691, 0.71755}, {0.182332, 0.201992, 0.353827}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, Y), W), Z) + TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) - std::array<std::array<double, 3>, 4>{{{0.529726, 0.626845, 0.934115}, {0.638741, 0.836759, 0.936517}, {0.41579, 0.498691, 0.71755}, {0.182332, 0.201992, 0.353827}}}) << colorOff << std::endl;
   std::cout << w << "TensorProduct(U,X) = " << (TensorProduct(U, X)) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{0.566205, 0.402113, 0.421288, 0.24264}, {0.294716, 0.209304, 0.219285, 0.126297}, {0.284966, 0.20238, 0.21203, 0.122119}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((TensorProduct(U, X)) - std::array<std::array<double, 4>, 3>{{{0.566205, 0.402113, 0.421288, 0.24264}, {0.294716, 0.209304, 0.219285, 0.126297}, {0.284966, 0.20238, 0.21203, 0.122119}}}) << colorOff << std::endl;
   std::cout << w << "TensorProduct(U,X)+TensorProduct(U,X) = " << (TensorProduct(U, X) + TensorProduct(U, X)) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{1.13241, 0.804227, 0.842575, 0.485281}, {0.589431, 0.418609, 0.438569, 0.252594}, {0.569932, 0.40476, 0.42406, 0.244237}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((TensorProduct(U, X) + TensorProduct(U, X)) - std::array<std::array<double, 4>, 3>{{{1.13241, 0.804227, 0.842575, 0.485281}, {0.589431, 0.418609, 0.438569, 0.252594}, {0.569932, 0.40476, 0.42406, 0.244237}}}) << colorOff << std::endl;
   std::cout << w << "Dot(U,TensorProduct(U,X)) = " << (Dot(U, TensorProduct(U, X))) << std::endl;
   std::cout << w << std::array<double, 4>{{0.50557, 0.359051, 0.376172, 0.216656}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(U, TensorProduct(U, X))) - std::array<double, 4>{{0.50557, 0.359051, 0.376172, 0.216656}}) << colorOff << std::endl;
   std::cout << w << "Norm(Dot(U,TensorProduct(U,X))) = " << (Norm(Dot(U, TensorProduct(U, X)))) << std::endl;
   std::cout << w << 0.756944 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Norm(Dot(U, TensorProduct(U, X)))) - 0.756944) << colorOff << std::endl;
   std::cout << w << "Total(Dot(U,TensorProduct(U,X))) = " << (Total(Dot(U, TensorProduct(U, X)))) << std::endl;
   std::cout << w << 1.45745 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Dot(U, TensorProduct(U, X)))) - 1.45745) << colorOff << std::endl;
   std::cout << w << "Total(Dot(U,TensorProduct(U,X))+Dot(W,TensorProduct(V,Y))) = " << (Total(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) << std::endl;
   std::cout << w << 2.33075 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) - 2.33075) << colorOff << std::endl;
   std::cout << w << "Norm(Dot(U,TensorProduct(U,X))+Dot(W,TensorProduct(V,Y))) = " << (Norm(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) << std::endl;
   std::cout << w << 1.21821 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Norm(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) - 1.21821) << colorOff << std::endl;
   std::cout << w << "Total(TensorProduct(U,X)) = " << (Total(TensorProduct(U, X))) << std::endl;
   std::cout << w << std::array<double, 4>{{1.14589, 0.813798, 0.852602, 0.491056}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(TensorProduct(U, X))) - std::array<double, 4>{{1.14589, 0.813798, 0.852602, 0.491056}}) << colorOff << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))+TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) + TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{1.65762, 1.7249, 1.27851, 0.617155}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) + TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{1.65762, 1.7249, 1.27851, 0.617155}}) << colorOff << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))-TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{-0.0408861, -0.576709, -0.0755751, 0.0756766}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{-0.0408861, -0.576709, -0.0755751, 0.0756766}}) << colorOff << std::endl;
   std::cout << w << "Total(TensorProduct(V,TensorProduct(U,X))-TensorProduct(W,TensorProduct(V,Y))) = " << (Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y)))) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{0.23992, 0.0675227, 0.170033, 0.12032}, {0.182361, 0.113036, 0.134328, 0.080952}, {-0.463167, -0.757268, -0.379936, -0.125595}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y)))) - std::array<std::array<double, 4>, 3>{{{0.23992, 0.0675227, 0.170033, 0.12032}, {0.182361, 0.113036, 0.134328, 0.080952}, {-0.463167, -0.757268, -0.379936, -0.125595}}}) << colorOff << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))*TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) * TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{0.060005, 0.0577466, 0.0355937, 0.00819768}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) * TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{0.060005, 0.0577466, 0.0355937, 0.00819768}}) << colorOff << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))/TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) / TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{37.1015, 19.4447, 34.6271, 49.8731}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) / TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{37.1015, 19.4447, 34.6271, 49.8731}}) << colorOff << std::endl;
   std::cout << w << "Total(TensorProduct(V,TensorProduct(U,V))-TensorProduct(W,Inverse(TensorProduct(U,V)))) = " << (Total(TensorProduct(V, TensorProduct(U, V)) - TensorProduct(W, Inverse(TensorProduct(U, V))))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0547573 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.00876983 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.228008 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}]}, {0.0285017 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.00456479 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.11868 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}]}, {0.0275588 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.00441378 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.114754 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}]}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(TensorProduct(V, TensorProduct(U, V)) - TensorProduct(W, Inverse(TensorProduct(U, V))))) - std::array<std::array<double, 3>, 3>{{{0.0547573 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.00876983 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.228008 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}]}, {0.0285017 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.00456479 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.11868 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}]}, {0.0275588 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.00441378 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}], 0.114754 - 3 {0.501788, 0.748433, 0.522016} \[TensorProduct] Inverse[{{0.0776202, 0.0124315, 0.323208}, {0.0404021, 0.00647073, 0.168233}, {0.0390655, 0.00625667, 0.162668}}]}}}) << colorOff << std::endl;
}