#include <algorithm>
#include <array>
#include <iostream>
#include <string>
#include <type_traits>
// #include "basic.hpp"
#include "basic_IO.hpp"
#include "basic_arithmetic_array_operations.hpp"
#include "basic_linear_systems.hpp"
#include "lib_measurement.hpp"

// /Users/tomoaki/Library/CloudStorage/Dropbox/code/cpp/builds/build_array/array演算が正しく行われているか.nb

int main() {
   auto w = std::setw(30);
   auto rand = 0.94996;
   auto irand = 6;
   std::array<std::array<double, 3>, 3> a{{{0.122682, 0.950951, 0.740183}, {0.316026, 0.385666, 0.137458}, {0.127685, 0.0278074, 0.0933522}}};
   std::array<std::array<double, 3>, 3> b{{{0.78403, 0.995972, 0.458295}, {0.0428954, 0.551449, 0.512619}, {0.515394, 0.782273, 0.193142}}};
   std::array<double, 3> row = {0.884879, 0.533232, 0.236619};
   std::array<double, 3> U = {0.961402, 0.86149, 0.849788};
   std::array<double, 3> V = {0.0891845, 0.280026, 0.882568};
   std::array<double, 3> W = {0.0995021, 0.970959, 0.340957};
   std::array<double, 4> X = {0.915186, 0.901562, 0.663086, 0.684876};
   std::array<double, 4> Y = {0.137487, 0.11821, 0.875556, 0.0752209};
   std::array<double, 4> Z = {0.119909, 0.612034, 0.234712, 0.520983};
   std::cout << w << "Eigenvalues(a) = " << (Eigenvalues(a)) << std::endl;
   std::cout << w << std::array<double, 3>{{0.89486, -0.398048, 0.104888}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Eigenvalues(a)) - std::array<double, 3>{{0.89486, -0.398048, 0.104888}}) << colorReset << std::endl;
   std::cout << w << "Inverse(a) = " << (Inverse(a)) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.861337, 1.82519, 4.14195}, {0.319862, 2.22311, -5.80962}, {1.08284, -3.15866, 6.77741}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Inverse(a)) - std::array<std::array<double, 3>, 3>{{{-0.861337, 1.82519, 4.14195}, {0.319862, 2.22311, -5.80962}, {1.08284, -3.15866, 6.77741}}}) << colorReset << std::endl;
   std::cout << "Vector Operation" << std::endl;
   std::cout << w << "Dot(U,V) = " << (Dot(U, V)) << std::endl;
   std::cout << w << 1.07698 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(U, V)) - 1.07698) << colorReset << std::endl;
   std::cout << w << "Cross(U,V) = " << (Cross(U, V)) << std::endl;
   std::cout << w << std::array<double, 3>{{0.522361, -0.772715, 0.192386}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Cross(U, V)) - std::array<double, 3>{{0.522361, -0.772715, 0.192386}}) << colorReset << std::endl;
   std::cout << w << "Det(a) = " << (Det(a)) << std::endl;
   std::cout << w << -0.037361 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Det(a)) - -0.037361) << colorReset << std::endl;
   std::cout << "Arithmetic Operation" << std::endl;
   std::cout << w << "rand = " << (rand) << std::endl;
   std::cout << w << 0.94996 << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand)-0.94996) << colorReset << std::endl;
   std::cout << w << "irand = " << (irand) << std::endl;
   std::cout << w << 6 << std::endl;
   std::cout << w << Red << "Error = " << Norm((irand)-6) << colorReset << std::endl;
   std::cout << w << "a = " << (a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.122682, 0.950951, 0.740183}, {0.316026, 0.385666, 0.137458}, {0.127685, 0.0278074, 0.0933522}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a)-std::array<std::array<double, 3>, 3>{{{0.122682, 0.950951, 0.740183}, {0.316026, 0.385666, 0.137458}, {0.127685, 0.0278074, 0.0933522}}}) << colorReset << std::endl;
   std::cout << w << "b = " << (b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.78403, 0.995972, 0.458295}, {0.0428954, 0.551449, 0.512619}, {0.515394, 0.782273, 0.193142}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((b)-std::array<std::array<double, 3>, 3>{{{0.78403, 0.995972, 0.458295}, {0.0428954, 0.551449, 0.512619}, {0.515394, 0.782273, 0.193142}}}) << colorReset << std::endl;
   std::cout << w << "a/irand = " << (a / irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0204471, 0.158492, 0.123364}, {0.052671, 0.0642776, 0.0229097}, {0.0212808, 0.00463457, 0.0155587}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a / irand) - std::array<std::array<double, 3>, 3>{{{0.0204471, 0.158492, 0.123364}, {0.052671, 0.0642776, 0.0229097}, {0.0212808, 0.00463457, 0.0155587}}}) << colorReset << std::endl;
   std::cout << w << "row = " << (row) << std::endl;
   std::cout << w << std::array<double, 3>{{0.884879, 0.533232, 0.236619}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row)-std::array<double, 3>{{0.884879, 0.533232, 0.236619}}) << colorReset << std::endl;
   std::cout << w << "row/irand = " << (row / irand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.14748, 0.088872, 0.0394365}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row / irand) - std::array<double, 3>{{0.14748, 0.088872, 0.0394365}}) << colorReset << std::endl;
   std::cout << "negate" << std::endl;
   std::cout << w << "-a = " << (-a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.122682, -0.950951, -0.740183}, {-0.316026, -0.385666, -0.137458}, {-0.127685, -0.0278074, -0.0933522}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((-a) - std::array<std::array<double, 3>, 3>{{{-0.122682, -0.950951, -0.740183}, {-0.316026, -0.385666, -0.137458}, {-0.127685, -0.0278074, -0.0933522}}}) << colorReset << std::endl;
   std::cout << w << "-b = " << (-b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.78403, -0.995972, -0.458295}, {-0.0428954, -0.551449, -0.512619}, {-0.515394, -0.782273, -0.193142}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((-b) - std::array<std::array<double, 3>, 3>{{{-0.78403, -0.995972, -0.458295}, {-0.0428954, -0.551449, -0.512619}, {-0.515394, -0.782273, -0.193142}}}) << colorReset << std::endl;
   std::cout << "+" << std::endl;
   std::cout << w << "a+b = " << (a + b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.906713, 1.94692, 1.19848}, {0.358921, 0.937115, 0.650077}, {0.643079, 0.81008, 0.286494}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + b) - std::array<std::array<double, 3>, 3>{{{0.906713, 1.94692, 1.19848}, {0.358921, 0.937115, 0.650077}, {0.643079, 0.81008, 0.286494}}}) << colorReset << std::endl;
   std::cout << w << "a-b = " << (a - b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.661348, -0.0450214, 0.281888}, {0.273131, -0.165784, -0.375161}, {-0.387709, -0.754465, -0.0997894}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a - b) - std::array<std::array<double, 3>, 3>{{{-0.661348, -0.0450214, 0.281888}, {0.273131, -0.165784, -0.375161}, {-0.387709, -0.754465, -0.0997894}}}) << colorReset << std::endl;
   std::cout << w << "a+row = " << (a + row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.00756, 1.83583, 1.62506}, {0.849258, 0.918898, 0.67069}, {0.364304, 0.264426, 0.329971}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + row) - std::array<std::array<double, 3>, 3>{{{1.00756, 1.83583, 1.62506}, {0.849258, 0.918898, 0.67069}, {0.364304, 0.264426, 0.329971}}}) << colorReset << std::endl;
   std::cout << w << "row+a = " << (row + a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.00756, 1.83583, 1.62506}, {0.849258, 0.918898, 0.67069}, {0.364304, 0.264426, 0.329971}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row + a) - std::array<std::array<double, 3>, 3>{{{1.00756, 1.83583, 1.62506}, {0.849258, 0.918898, 0.67069}, {0.364304, 0.264426, 0.329971}}}) << colorReset << std::endl;
   std::cout << w << "a+irand = " << (a + irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{6.12268, 6.95095, 6.74018}, {6.31603, 6.38567, 6.13746}, {6.12769, 6.02781, 6.09335}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + irand) - std::array<std::array<double, 3>, 3>{{{6.12268, 6.95095, 6.74018}, {6.31603, 6.38567, 6.13746}, {6.12769, 6.02781, 6.09335}}}) << colorReset << std::endl;
   std::cout << w << "row+irand = " << (row + irand) << std::endl;
   std::cout << w << std::array<double, 3>{{6.88488, 6.53323, 6.23662}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row + irand) - std::array<double, 3>{{6.88488, 6.53323, 6.23662}}) << colorReset << std::endl;
   std::cout << "-" << std::endl;
   std::cout << w << "a-row = " << (a - row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{-0.762197, 0.0660719, -0.144696}, {-0.217206, -0.147566, -0.395774}, {-0.108934, -0.208812, -0.143267}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a - row) - std::array<std::array<double, 3>, 3>{{{-0.762197, 0.0660719, -0.144696}, {-0.217206, -0.147566, -0.395774}, {-0.108934, -0.208812, -0.143267}}}) << colorReset << std::endl;
   std::cout << w << "row-a = " << (row - a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.762197, -0.0660719, 0.144696}, {0.217206, 0.147566, 0.395774}, {0.108934, 0.208812, 0.143267}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row - a) - std::array<std::array<double, 3>, 3>{{{0.762197, -0.0660719, 0.144696}, {0.217206, 0.147566, 0.395774}, {0.108934, 0.208812, 0.143267}}}) << colorReset << std::endl;
   std::cout << w << "a+rand = " << (a + rand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.07264, 1.90091, 1.69014}, {1.26599, 1.33563, 1.08742}, {1.07764, 0.977767, 1.04331}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + rand) - std::array<std::array<double, 3>, 3>{{{1.07264, 1.90091, 1.69014}, {1.26599, 1.33563, 1.08742}, {1.07764, 0.977767, 1.04331}}}) << colorReset << std::endl;
   std::cout << w << "rand+a = " << (rand + a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{1.07264, 1.90091, 1.69014}, {1.26599, 1.33563, 1.08742}, {1.07764, 0.977767, 1.04331}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand + a) - std::array<std::array<double, 3>, 3>{{{1.07264, 1.90091, 1.69014}, {1.26599, 1.33563, 1.08742}, {1.07764, 0.977767, 1.04331}}}) << colorReset << std::endl;
   std::cout << w << "a+irand = " << (a + irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{6.12268, 6.95095, 6.74018}, {6.31603, 6.38567, 6.13746}, {6.12769, 6.02781, 6.09335}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a + irand) - std::array<std::array<double, 3>, 3>{{{6.12268, 6.95095, 6.74018}, {6.31603, 6.38567, 6.13746}, {6.12769, 6.02781, 6.09335}}}) << colorReset << std::endl;
   std::cout << w << "row+irand = " << (row + irand) << std::endl;
   std::cout << w << std::array<double, 3>{{6.88488, 6.53323, 6.23662}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row + irand) - std::array<double, 3>{{6.88488, 6.53323, 6.23662}}) << colorReset << std::endl;
   std::cout << "*" << std::endl;
   std::cout << w << "row*rand = " << (row * rand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.8406, 0.506549, 0.224779}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row * rand) - std::array<double, 3>{{0.8406, 0.506549, 0.224779}}) << colorReset << std::endl;
   std::cout << w << "rand*row = " << (rand * row) << std::endl;
   std::cout << w << std::array<double, 3>{{0.8406, 0.506549, 0.224779}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand * row) - std::array<double, 3>{{0.8406, 0.506549, 0.224779}}) << colorReset << std::endl;
   std::cout << w << "a*rand = " << (a * rand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.116543, 0.903365, 0.703144}, {0.300212, 0.366367, 0.13058}, {0.121296, 0.0264159, 0.0886808}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a * rand) - std::array<std::array<double, 3>, 3>{{{0.116543, 0.903365, 0.703144}, {0.300212, 0.366367, 0.13058}, {0.121296, 0.0264159, 0.0886808}}}) << colorReset << std::endl;
   std::cout << w << "rand*a = " << (rand * a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.116543, 0.903365, 0.703144}, {0.300212, 0.366367, 0.13058}, {0.121296, 0.0264159, 0.0886808}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand * a) - std::array<std::array<double, 3>, 3>{{{0.116543, 0.903365, 0.703144}, {0.300212, 0.366367, 0.13058}, {0.121296, 0.0264159, 0.0886808}}}) << colorReset << std::endl;
   std::cout << w << "a*irand = " << (a * irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.736095, 5.70571, 4.4411}, {1.89616, 2.31399, 0.824748}, {0.76611, 0.166844, 0.560113}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a * irand) - std::array<std::array<double, 3>, 3>{{{0.736095, 5.70571, 4.4411}, {1.89616, 2.31399, 0.824748}, {0.76611, 0.166844, 0.560113}}}) << colorReset << std::endl;
   std::cout << w << "row*irand = " << (row * irand) << std::endl;
   std::cout << w << std::array<double, 3>{{5.30927, 3.19939, 1.41971}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row * irand) - std::array<double, 3>{{5.30927, 3.19939, 1.41971}}) << colorReset << std::endl;
   std::cout << "/" << std::endl;
   std::cout << w << "row/rand = " << (row / rand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.931491, 0.561321, 0.249083}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row / rand) - std::array<double, 3>{{0.931491, 0.561321, 0.249083}}) << colorReset << std::endl;
   std::cout << w << "rand/row = " << (rand / row) << std::endl;
   std::cout << w << std::array<double, 3>{{1.07355, 1.78151, 4.01472}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand / row) - std::array<double, 3>{{1.07355, 1.78151, 4.01472}}) << colorReset << std::endl;
   std::cout << w << "a/rand = " << (a / rand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.129145, 1.00104, 0.779173}, {0.332673, 0.405981, 0.144699}, {0.134411, 0.0292722, 0.0982696}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a / rand) - std::array<std::array<double, 3>, 3>{{{0.129145, 1.00104, 0.779173}, {0.332673, 0.405981, 0.144699}, {0.134411, 0.0292722, 0.0982696}}}) << colorReset << std::endl;
   std::cout << w << "rand/a = " << (rand / a) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{7.74324, 0.998958, 1.28341}, {3.00596, 2.46317, 6.91091}, {7.43987, 34.1621, 10.1761}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((rand / a) - std::array<std::array<double, 3>, 3>{{{7.74324, 0.998958, 1.28341}, {3.00596, 2.46317, 6.91091}, {7.43987, 34.1621, 10.1761}}}) << colorReset << std::endl;
   std::cout << w << "a/irand = " << (a / irand) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0204471, 0.158492, 0.123364}, {0.052671, 0.0642776, 0.0229097}, {0.0212808, 0.00463457, 0.0155587}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a / irand) - std::array<std::array<double, 3>, 3>{{{0.0204471, 0.158492, 0.123364}, {0.052671, 0.0642776, 0.0229097}, {0.0212808, 0.00463457, 0.0155587}}}) << colorReset << std::endl;
   std::cout << w << "row/irand = " << (row / irand) << std::endl;
   std::cout << w << std::array<double, 3>{{0.14748, 0.088872, 0.0394365}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((row / irand) - std::array<double, 3>{{0.14748, 0.088872, 0.0394365}}) << colorReset << std::endl;
   std::cout << "+=, -=, *=, /=" << std::endl;
   std::cout << w << "a+=b = " << (a += b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.906713, 1.94692, 1.19848}, {0.358921, 0.937115, 0.650077}, {0.643079, 0.81008, 0.286494}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a += b) - std::array<std::array<double, 3>, 3>{{{0.906713, 1.94692, 1.19848}, {0.358921, 0.937115, 0.650077}, {0.643079, 0.81008, 0.286494}}}) << colorReset << std::endl;
   std::cout << w << "a-=b = " << (a -= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.906713, 1.94692, 1.19848}, {0.358921, 0.937115, 0.650077}, {0.643079, 0.81008, 0.286494}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a -= b) - std::array<std::array<double, 3>, 3>{{{0.906713, 1.94692, 1.19848}, {0.358921, 0.937115, 0.650077}, {0.643079, 0.81008, 0.286494}}}) << colorReset << std::endl;
   std::cout << w << "a*=b = " << (a *= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0961868, 0.947121, 0.339222}, {0.0135561, 0.212675, 0.0704637}, {0.0658081, 0.021753, 0.0180302}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a *= b) - std::array<std::array<double, 3>, 3>{{{0.0961868, 0.947121, 0.339222}, {0.0135561, 0.212675, 0.0704637}, {0.0658081, 0.021753, 0.0180302}}}) << colorReset << std::endl;
   std::cout << w << "a*=row = " << (a *= row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0667317, 0.834712, 0.137567}, {0.00031007, 0.0625373, 0.0192609}, {0.00802542, 0.00402649, 0.000823997}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a *= row) - std::array<std::array<double, 3>, 3>{{{0.0667317, 0.834712, 0.137567}, {0.00031007, 0.0625373, 0.0192609}, {0.00802542, 0.00402649, 0.000823997}}}) << colorReset << std::endl;
   std::cout << w << "a/=b = " << (a /= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.0753153, 0.741606, 0.265615}, {0.00385448, 0.0604713, 0.0200354}, {0.0036845, 0.00121792, 0.00100948}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= b) - std::array<std::array<double, 3>, 3>{{{0.0753153, 0.741606, 0.265615}, {0.00385448, 0.0604713, 0.0200354}, {0.0036845, 0.00121792, 0.00100948}}}) << colorReset << std::endl;
   std::cout << w << "a/=row = " << (a /= row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.108559, 0.841477, 0.654972}, {0.168515, 0.205649, 0.0732971}, {0.0302127, 0.00657976, 0.0220889}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= row) - std::array<std::array<double, 3>, 3>{{{0.108559, 0.841477, 0.654972}, {0.168515, 0.205649, 0.0732971}, {0.0302127, 0.00657976, 0.0220889}}}) << colorReset << std::endl;
   std::cout << w << "a/=b = " << (a /= b) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.156477, 0.954797, 1.61508}, {7.36736, 0.699367, 0.268148}, {0.247743, 0.0355469, 0.483335}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= b) - std::array<std::array<double, 3>, 3>{{{0.156477, 0.954797, 1.61508}, {7.36736, 0.699367, 0.268148}, {0.247743, 0.0355469, 0.483335}}}) << colorReset << std::endl;
   std::cout << w << "a/=row = " << (a /= row) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 3>{{{0.225545, 1.08338, 3.98258}, {322.096, 2.37839, 0.980989}, {2.03148, 0.192041, 10.576}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((a /= row) - std::array<std::array<double, 3>, 3>{{{0.225545, 1.08338, 3.98258}, {322.096, 2.37839, 0.980989}, {2.03148, 0.192041, 10.576}}}) << colorReset << std::endl;
   std::cout << "Tensor Operation" << std::endl;
   std::cout << w << "TensorProduct(U,X) = " << (TensorProduct(U, X)) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{0.879861, 0.866763, 0.637492, 0.658441}, {0.788423, 0.776686, 0.571242, 0.590014}, {0.777713, 0.766136, 0.563482, 0.581999}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((TensorProduct(U, X)) - std::array<std::array<double, 4>, 3>{{{0.879861, 0.866763, 0.637492, 0.658441}, {0.788423, 0.776686, 0.571242, 0.590014}, {0.777713, 0.766136, 0.563482, 0.581999}}}) << colorReset << std::endl;
   std::cout << w << "Dot(W,TensorProduct(TensorProduct(U,X),V)) = " << (Dot(W, TensorProduct(TensorProduct(U, X), V))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.0997298, 0.313137, 0.986924}, {0.0982452, 0.308475, 0.972233}, {0.072258, 0.226879, 0.715063}, {0.0746325, 0.234335, 0.738562}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, TensorProduct(TensorProduct(U, X), V))) - std::array<std::array<double, 3>, 4>{{{0.0997298, 0.313137, 0.986924}, {0.0982452, 0.308475, 0.972233}, {0.072258, 0.226879, 0.715063}, {0.0746325, 0.234335, 0.738562}}}) << colorReset << std::endl;
   std::cout << w << "Dot(Z,Dot(W,TensorProduct(TensorProduct(TensorProduct(U,X),V),Y))) = " << (Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(U, X), V), Y)))) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{0.0175887, 0.0151227, 0.11201, 0.00962301}, {0.0552259, 0.0474829, 0.351694, 0.0302148}, {0.174057, 0.149654, 1.10845, 0.0952291}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(U, X), V), Y)))) - std::array<std::array<double, 4>, 3>{{{0.0175887, 0.0151227, 0.11201, 0.00962301}, {0.0552259, 0.0474829, 0.351694, 0.0302148}, {0.174057, 0.149654, 1.10845, 0.0952291}}}) << colorReset << std::endl;
   std::cout << w << "Dot(Y,Dot(U,Dot(Z,Dot(W,TensorProduct(TensorProduct(TensorProduct(TensorProduct(U,X),V),Y),Z))))) = " << (Dot(Y, Dot(U, Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z)))))) << std::endl;
   std::cout << w << std::array<double, 4>{{0.149145, 0.76126, 0.291939, 0.648009}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(Y, Dot(U, Dot(Z, Dot(W, TensorProduct(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z)))))) - std::array<double, 4>{{0.149145, 0.76126, 0.291939, 0.648009}}) << colorReset << std::endl;
   std::cout << w << "Dot(W,10*TensorProduct(TensorProduct(U,X),V)) = " << (Dot(W, 10 * TensorProduct(TensorProduct(U, X), V))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.997298, 3.13137, 9.86924}, {0.982452, 3.08475, 9.72233}, {0.72258, 2.26879, 7.15063}, {0.746325, 2.34335, 7.38562}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, 10 * TensorProduct(TensorProduct(U, X), V))) - std::array<std::array<double, 3>, 4>{{{0.997298, 3.13137, 9.86924}, {0.982452, 3.08475, 9.72233}, {0.72258, 2.26879, 7.15063}, {0.746325, 2.34335, 7.38562}}}) << colorReset << std::endl;
   std::cout << w << "Dot(W,Dot(TensorProduct(TensorProduct(TensorProduct(U,X),V),Y),Z)) = " << (Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.0332626, 0.10444, 0.329166}, {0.0327674, 0.102885, 0.324266}, {0.0241, 0.0756703, 0.238493}, {0.0248919, 0.078157, 0.24633}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) - std::array<std::array<double, 3>, 4>{{{0.0332626, 0.10444, 0.329166}, {0.0327674, 0.102885, 0.324266}, {0.0241, 0.0756703, 0.238493}, {0.0248919, 0.078157, 0.24633}}}) << colorReset << std::endl;
   std::cout << w << "Dot(W,Dot(TensorProduct(TensorProduct(TensorProduct(U,Y),W),Z)+TensorProduct(TensorProduct(TensorProduct(U,X),V),Y),Z)) = " << (Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, Y), W), Z) + TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) << std::endl;
   std::cout << w << std::array<std::array<double, 3>, 4>{{{0.0452222, 0.221143, 0.370147}, {0.0430502, 0.203226, 0.359501}, {0.100262, 0.818873, 0.499472}, {0.0314352, 0.142007, 0.268752}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(W, Dot(TensorProduct(TensorProduct(TensorProduct(U, Y), W), Z) + TensorProduct(TensorProduct(TensorProduct(U, X), V), Y), Z))) - std::array<std::array<double, 3>, 4>{{{0.0452222, 0.221143, 0.370147}, {0.0430502, 0.203226, 0.359501}, {0.100262, 0.818873, 0.499472}, {0.0314352, 0.142007, 0.268752}}}) << colorReset << std::endl;
   std::cout << w << "TensorProduct(U,X) = " << (TensorProduct(U, X)) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{0.879861, 0.866763, 0.637492, 0.658441}, {0.788423, 0.776686, 0.571242, 0.590014}, {0.777713, 0.766136, 0.563482, 0.581999}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((TensorProduct(U, X)) - std::array<std::array<double, 4>, 3>{{{0.879861, 0.866763, 0.637492, 0.658441}, {0.788423, 0.776686, 0.571242, 0.590014}, {0.777713, 0.766136, 0.563482, 0.581999}}}) << colorReset << std::endl;
   std::cout << w << "TensorProduct(U,X)+TensorProduct(U,X) = " << (TensorProduct(U, X) + TensorProduct(U, X)) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{1.75972, 1.73353, 1.27498, 1.31688}, {1.57685, 1.55337, 1.14248, 1.18003}, {1.55543, 1.53227, 1.12696, 1.164}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((TensorProduct(U, X) + TensorProduct(U, X)) - std::array<std::array<double, 4>, 3>{{{1.75972, 1.73353, 1.27498, 1.31688}, {1.57685, 1.55337, 1.14248, 1.18003}, {1.55543, 1.53227, 1.12696, 1.164}}}) << colorReset << std::endl;
   std::cout << w << "Dot(U,TensorProduct(U,X)) = " << (Dot(U, TensorProduct(U, X))) << std::endl;
   std::cout << w << std::array<double, 4>{{2.18601, 2.15347, 1.58385, 1.63589}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Dot(U, TensorProduct(U, X))) - std::array<double, 4>{{2.18601, 2.15347, 1.58385, 1.63589}}) << colorReset << std::endl;
   std::cout << w << "Norm(Dot(U,TensorProduct(U,X))) = " << (Norm(Dot(U, TensorProduct(U, X)))) << std::endl;
   std::cout << w << 3.8211 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Norm(Dot(U, TensorProduct(U, X)))) - 3.8211) << colorReset << std::endl;
   std::cout << w << "Total(Dot(U,TensorProduct(U,X))) = " << (Total(Dot(U, TensorProduct(U, X)))) << std::endl;
   std::cout << w << 7.55922 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Dot(U, TensorProduct(U, X)))) - 7.55922) << colorReset << std::endl;
   std::cout << w << "Total(Dot(U,TensorProduct(U,X))+Dot(W,TensorProduct(V,Y))) = " << (Total(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) << std::endl;
   std::cout << w << 8.26101 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) - 8.26101) << colorReset << std::endl;
   std::cout << w << "Norm(Dot(U,TensorProduct(U,X))+Dot(W,TensorProduct(V,Y))) = " << (Norm(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) << std::endl;
   std::cout << w << 4.15638 << std::endl;
   std::cout << w << Red << "Error = " << Norm((Norm(Dot(U, TensorProduct(U, X)) + Dot(W, TensorProduct(V, Y)))) - 4.15638) << colorReset << std::endl;
   std::cout << w << "Total(TensorProduct(U,X)) = " << (Total(TensorProduct(U, X))) << std::endl;
   std::cout << w << std::array<double, 4>{{2.446, 2.40959, 1.77222, 1.83045}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(TensorProduct(U, X))) - std::array<double, 4>{{2.446, 2.40959, 1.77222, 1.83045}}) << colorReset << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))+TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) + TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{3.30476, 3.22512, 3.76534, 2.42422}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) + TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{3.30476, 3.22512, 3.76534, 2.42422}}) << colorReset << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))-TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{2.81894, 2.80741, 0.671503, 2.15842}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{2.81894, 2.80741, 0.671503, 2.15842}}) << colorReset << std::endl;
   std::cout << w << "Total(TensorProduct(V,TensorProduct(U,X))-TensorProduct(W,TensorProduct(V,Y))) = " << (Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y)))) << std::endl;
   std::cout << w << std::array<std::array<double, 4>, 3>{{{1.08408, 1.07012, 0.687787, 0.814754}, {0.932591, 0.925518, 0.369018, 0.708837}, {0.802261, 0.811781, -0.385302, 0.634833}}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(TensorProduct(V, TensorProduct(U, X)) - TensorProduct(W, TensorProduct(V, Y)))) - std::array<std::array<double, 4>, 3>{{{1.08408, 1.07012, 0.687787, 0.814754}, {0.932591, 0.925518, 0.369018, 0.708837}, {0.802261, 0.811781, -0.385302, 0.634833}}}) << colorReset << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))*TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) * TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{0.0788252, 0.0667646, 0.363705, 0.0322735}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) * TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{0.0788252, 0.0667646, 0.363705, 0.0322735}}) << colorReset << std::endl;
   std::cout << w << "Total(Total(TensorProduct(V,TensorProduct(U,X))/TensorProduct(W,TensorProduct(V,Y)))) = " << (Total(Total(TensorProduct(V, TensorProduct(U, X)) / TensorProduct(W, TensorProduct(V, Y))))) << std::endl;
   std::cout << w << std::array<double, 4>{{372.207, 426.458, 42.347, 509.108}} << std::endl;
   std::cout << w << Red << "Error = " << Norm((Total(Total(TensorProduct(V, TensorProduct(U, X)) / TensorProduct(W, TensorProduct(V, Y))))) - std::array<double, 4>{{372.207, 426.458, 42.347, 509.108}}) << colorReset << std::endl;
}